"use strict";(self.webpackChunkmd=self.webpackChunkmd||[]).push([[4691],{4137:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>p});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),d=u(n),p=a,g=d["".concat(l,".").concat(p)]||d[p]||m[p]||r;return n?i.createElement(g,s(s({ref:t},c),{},{components:n})):i.createElement(g,s({ref:t},c))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var u=2;u<r;u++)s[u]=n[u];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1872:(e,t,n)=>{n.d(t,{m:()=>r});var i=n(7294);const a="leadText_qzwo",r=e=>{let{content:t}=e;return i.createElement(i.Fragment,null,i.createElement("p",{id:a},t))}},1887:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var i=n(7462),a=(n(7294),n(4137)),r=n(1872);const s={id:"sfmc-sql-snippet-debugging-email-sends",title:"SFMC SQL Debugging Email Sends",sidebar_label:"Debugging Email Sends",description:"Make finding problems with email delivery in Salesforce Marketing Cloud great again. SQL with Query Studio to the rescue.",image:"img/og/og-image-sql-debugging-email-sends.png",tags:["Marketing Cloud","SQL","Snippet","Email","Debugging","Analytics"]},o=void 0,l={unversionedId:"sql/sfmc-sql-snippet-debugging-email-sends",id:"sql/sfmc-sql-snippet-debugging-email-sends",title:"SFMC SQL Debugging Email Sends",description:"Make finding problems with email delivery in Salesforce Marketing Cloud great again. SQL with Query Studio to the rescue.",source:"@site/docs/sql/sfmc-sql-snippet-debugging-email-sends.mdx",sourceDirName:"sql",slug:"/sql/sfmc-sql-snippet-debugging-email-sends",permalink:"/docs/sql/sfmc-sql-snippet-debugging-email-sends",draft:!1,editUrl:"https://github.com/MateuszDabrowski/mateuszdabrowski.pl/edit/master/docs/sql/sfmc-sql-snippet-debugging-email-sends.mdx",tags:[{label:"Marketing Cloud",permalink:"/docs/tags/marketing-cloud"},{label:"SQL",permalink:"/docs/tags/sql"},{label:"Snippet",permalink:"/docs/tags/snippet"},{label:"Email",permalink:"/docs/tags/email"},{label:"Debugging",permalink:"/docs/tags/debugging"},{label:"Analytics",permalink:"/docs/tags/analytics"}],version:"current",lastUpdatedBy:"Mateusz D\u0105browski",lastUpdatedAt:1643488086,formattedLastUpdatedAt:"Jan 29, 2022",frontMatter:{id:"sfmc-sql-snippet-debugging-email-sends",title:"SFMC SQL Debugging Email Sends",sidebar_label:"Debugging Email Sends",description:"Make finding problems with email delivery in Salesforce Marketing Cloud great again. SQL with Query Studio to the rescue.",image:"img/og/og-image-sql-debugging-email-sends.png",tags:["Marketing Cloud","SQL","Snippet","Email","Debugging","Analytics"]},sidebar:"snippets",previous:{title:"\xbb SQL Snippets",permalink:"/docs/category/-sql-snippets"},next:{title:"Debugging Value Length",permalink:"/docs/sql/sfmc-sql-snippet-debugging-value-length"}},u={},c=[{value:"Problem with straightforward Email Send analysis",id:"problem-with-straightforward-email-send-analysis",level:2},{value:"Solution",id:"solution",level:2},{value:"Options",id:"options",level:2},{value:"Change timeframe",id:"change-timeframe",level:3},{value:"Limit to single subscriber",id:"limit-to-single-subscriber",level:3},{value:"Limit to single domain",id:"limit-to-single-domain",level:3},{value:"Limit to single email",id:"limit-to-single-email",level:3},{value:"Limit to single journey",id:"limit-to-single-journey",level:3},{value:"Limit to single engagement type",id:"limit-to-single-engagement-type",level:3}],m={toc:c};function d(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(r.m,{content:"Make finding problems with email delivery in Salesforce Marketing Cloud great again. SQL with the Query Studio to the rescue.",mdxType:"LeadText"}),(0,a.kt)("h2",{id:"problem-with-straightforward-email-send-analysis"},"Problem with straightforward Email Send analysis"),(0,a.kt)("p",null,"Deliverability issues, unfortunately, are a standard both during the Salesforce Marketing Cloud implementation phase, as well as after the go-live."),(0,a.kt)("p",null,"The test you sent to yourself during the Marketing Cloud implementation that never arrived at the inbox. The subscriber that asks where is his newsletter with the promo code."),(0,a.kt)("p",null,"You can try to debug it with Journey Builder data or Reports, but in most cases, those solutions provide either not enough or way too much for the specific check you need to make."),(0,a.kt)("h2",{id:"solution"},"Solution"),(0,a.kt)("p",null,"My favourite way to debug email sends is by using a SQL Query. Open your ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-basics#query-studio"},"Query Studio")," and copy-paste the below code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n      s.SubscriberKey     AS SubscriberKey\n    , sub.EmailAddress    AS EmailAddress\n    , sub.Status          AS SubscriptionStatus\n    , j.JourneyName       AS JourneyName\n    , j.VersionNumber     AS JourneyVersion\n    , job.EmailName       AS EmailName\n    , s.EventDate         AS SentDate\n    , job.DeliveredTime   AS DeliveryDate\n    , o.EventDate         AS OpenDate\n    , c.EventDate         AS ClickDate\n    , b.EventDate         AS BounceDate\n    , b.BounceCategory    AS BounceCategory\n    , b.BounceSubcategory AS BounceSubcategory\n    , b.SMTPBounceReason  AS BounceReason\n    , u.EventDate         AS UnsubscribeDate\nFROM _Sent AS s\n    LEFT JOIN _Job AS job\n        ON job.JobID = s.JobID\n    LEFT JOIN _Open AS o\n        ON o.JobID = s.JobID\n        AND o.ListID = s.ListID\n        AND o.BatchID = s.BatchID\n        AND o.SubscriberID = s.SubscriberID\n        AND o.IsUnique = 1\n    LEFT JOIN _Click AS c\n        ON s.JobID = c.JobID\n        AND c.ListID = s.ListID\n        AND c.BatchID = s.BatchID\n        AND c.SubscriberID = s.SubscriberID\n        AND c.IsUnique = 1\n    LEFT JOIN _Bounce AS b\n        ON s.JobID = b.JobID\n        AND b.ListID = s.ListID\n        AND b.BatchID = s.BatchID\n        AND b.SubscriberID = s.SubscriberID\n        AND b.IsUnique = 1\n    LEFT JOIN _Unsubscribe AS u\n        ON s.JobID = u.JobID\n        AND u.ListID = s.ListID\n        AND u.BatchID = s.BatchID\n        AND u.SubscriberID = s.SubscriberID\n        AND u.IsUnique = 1\n    LEFT JOIN _JourneyActivity AS ja\n        ON ja.JourneyActivityObjectID = s.TriggererSendDefinitionObjectID\n    LEFT JOIN _Journey AS j\n        ON j.VersionID = ja.VersionID\n    LEFT JOIN _Subscribers AS sub\n        ON sub.SubscriberKey = s.SubscriberKey\nWHERE s.EventDate >= DATEADD(DAY, -1, GETDATE())\n")),(0,a.kt)("p",null,"Within a few seconds you will see information about sends from the last day. With all the details that might be useful for debugging, like STMP Bounce Reason, Subscriber Status, Unsubscribe Date, etc."),(0,a.kt)("admonition",{title:"You Should Know",type:"note"},(0,a.kt)("p",{parentName:"admonition"},"If you are running it from child Business Unit and do not see EmailAddress, BounceCount and Status, add ",(0,a.kt)("inlineCode",{parentName:"p"},"Ent.")," prefix to ",(0,a.kt)("inlineCode",{parentName:"p"},"_Subscribers")," Data View name in the last ",(0,a.kt)("inlineCode",{parentName:"p"},"JOIN"),". It will pull the data from _Subscribers of parent Business Unit.")),(0,a.kt)("p",null,"If you don't see the send in the outcomes at all - check whether it errored out in the ",(0,a.kt)("a",{parentName:"p",href:"/docs/usecase/sfmc-enhanced-send-log"},"Send Log")," and confirm the subscriber status in Email Studio."),(0,a.kt)("h2",{id:"options"},"Options"),(0,a.kt)("p",null,"You can even adapt the above query to better suit your needs."),(0,a.kt)("h3",{id:"change-timeframe"},"Change timeframe"),(0,a.kt)("p",null,"My default is checking the sends from last day. You can change it by modifying the ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-date-functions#dateadd"},(0,a.kt)("inlineCode",{parentName:"a"},"DATEADD")," function"),"."),(0,a.kt)("h3",{id:"limit-to-single-subscriber"},"Limit to single subscriber"),(0,a.kt)("p",null,"If you are looking for a problem related to only one specific subscriber you can add ",(0,a.kt)("inlineCode",{parentName:"p"},"s.SubscriberKey = 'SubscriberKeyOfThatContact'")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"sub.EmailAddress = 'specific@email.address'")," to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-where#logical-operators"},(0,a.kt)("inlineCode",{parentName:"a"},"WHERE")," statement"),". Or replace the current one not to be limited by the timeframe."),(0,a.kt)("h3",{id:"limit-to-single-domain"},"Limit to single domain"),(0,a.kt)("p",null,"If you see problems with deliverability for a particular user, I highly recommend checking whether any other users from the same domain are also having such issues. Maybe it is related to corporate server policy? Add ",(0,a.kt)("inlineCode",{parentName:"p"},"sub.Domain = 'Recipients.Domain'")," to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-where#logical-operators"},(0,a.kt)("inlineCode",{parentName:"a"},"WHERE")," statement"),". Or replace the current one not to be limited by the timeframe."),(0,a.kt)("h3",{id:"limit-to-single-email"},"Limit to single email"),(0,a.kt)("p",null,"If the problem is related to just one particular Email asset, you can limit your outcomes by adding ",(0,a.kt)("inlineCode",{parentName:"p"},"job.EmailName = 'ProblematicEmailName'")," to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-where#logical-operators"},(0,a.kt)("inlineCode",{parentName:"a"},"WHERE")," statement"),". Or replace the current one not to be limited by the timeframe."),(0,a.kt)("h3",{id:"limit-to-single-journey"},"Limit to single journey"),(0,a.kt)("p",null,"If you want to focus on a single Journey, you can limit your outcomes by adding ",(0,a.kt)("inlineCode",{parentName:"p"},"j.JourneyName = 'ProblematicJourneyName'")," to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-where#logical-operators"},(0,a.kt)("inlineCode",{parentName:"a"},"WHERE")," statement"),". Or replace the current one not to be limited by the timeframe. You can also pinpoint it even further by filtering on ",(0,a.kt)("inlineCode",{parentName:"p"},"j.JourneyVersion"),"."),(0,a.kt)("h3",{id:"limit-to-single-engagement-type"},"Limit to single engagement type"),(0,a.kt)("p",null,"If you are interested only in bounces and do not need any other sends, add ",(0,a.kt)("inlineCode",{parentName:"p"},"b.IsUnique = 1")," to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-where#logical-operators"},(0,a.kt)("inlineCode",{parentName:"a"},"WHERE")," statement"),"."),(0,a.kt)("p",null,"You can use the same approach to output only opens or clicks by changing the prefix from ",(0,a.kt)("inlineCode",{parentName:"p"},"b")," to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/sql/sfmc-sql-join#table-name-prefix"},"alias")," representing the needed ",(0,a.kt)("a",{parentName:"p",href:"/docs/config/sfmc-config-system-data-views"},"System Data View"),"."))}d.isMDXComponent=!0}}]);