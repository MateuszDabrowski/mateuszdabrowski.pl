"use strict";(self.webpackChunkmd=self.webpackChunkmd||[]).push([[7281],{6395:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var i=o(4848),s=o(8453),t=o(6748);const r={id:"ssjs-loops",title:"SSJS Loops",sidebar_label:"Loops",description:"Let's dive into limited looping options of the SSJS.",image:"img/og/og-image-ssjs-loops.png",tags:["Marketing Cloud","SSJS"]},l=void 0,a={id:"ssjs/ssjs-loops",title:"SSJS Loops",description:"Let's dive into limited looping options of the SSJS.",source:"@site/docs/ssjs/ssjs-loops.mdx",sourceDirName:"ssjs",slug:"/ssjs/ssjs-loops",permalink:"/docs/ssjs/ssjs-loops",draft:!1,unlisted:!1,editUrl:"https://github.com/MateuszDabrowski/mateuszdabrowski.pl/edit/master/docs/ssjs/ssjs-loops.mdx",tags:[{inline:!0,label:"Marketing Cloud",permalink:"/docs/tags/marketing-cloud"},{inline:!0,label:"SSJS",permalink:"/docs/tags/ssjs"}],version:"current",lastUpdatedBy:"Mateusz D\u0105browski",lastUpdatedAt:1632606565e3,frontMatter:{id:"ssjs-loops",title:"SSJS Loops",sidebar_label:"Loops",description:"Let's dive into limited looping options of the SSJS.",image:"img/og/og-image-ssjs-loops.png",tags:["Marketing Cloud","SSJS"]},sidebar:"docs",previous:{title:"If & Switch",permalink:"/docs/ssjs/ssjs-if-and-switch"},next:{title:"Debugging & Error Handling",permalink:"/docs/ssjs/debugging-ssjs"}},c={},d=[{value:"For Loops",id:"for-loops",level:2},{value:"For",id:"for",level:3},{value:"For in",id:"for-in",level:3},{value:"While Loops",id:"while-loops",level:2},{value:"While",id:"while",level:3},{value:"Do While",id:"do-while",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.U,{content:"Let's dive into limited looping options of the SSJS."}),"\n",(0,i.jsxs)(n.p,{children:["Working with arrays and objects is one of the selling points of SSJS vs AMPScript. And the primary way to utilize those structures is to loop over them. While SSJS doesn't have all the magic of the modern JavaScript, it still has much more to offer than single ",(0,i.jsx)(n.code,{children:"FOR"})," available in AMPScript."]}),"\n",(0,i.jsx)(n.h2,{id:"for-loops",children:"For Loops"}),"\n",(0,i.jsx)(n.h3,{id:"for",children:"For"}),"\n",(0,i.jsxs)(n.p,{children:["The classic ",(0,i.jsx)(n.code,{children:"for"})," loop might be a bit long to write, but it has a lot of excellent properties:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Works with ",(0,i.jsx)(n.code,{children:"break"})," and ",(0,i.jsx)(n.code,{children:"continue"})," statements for better looping control."]}),"\n",(0,i.jsx)(n.li,{children:"Both initial and increment expressions can do multiple things (examples available below)."}),"\n",(0,i.jsx)(n.li,{children:"Condition is not limited to iterable length (although it is the most popular way)."}),"\n",(0,i.jsx)(n.li,{children:"Fast across various scenarios."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'{1} title="Example of for loop iterating over an array"',children:"for (var i = 0; i < array.length; i++) {\n    Write(i);                           // Returns the current iteration\n    Write(array[i] + '<br/><br/>');     // Returns the value of current element\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Let's break the script down to five steps each ",(0,i.jsx)(n.code,{children:"for"})," loop follows:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Execute initial expression (",(0,i.jsx)(n.code,{children:"var i = 0"})," in the above example)."]}),"\n",(0,i.jsxs)(n.li,{children:["Evaluate the condition (",(0,i.jsx)(n.code,{children:"i < array.length"}),"). If it is false - the loop terminates. If true:"]}),"\n",(0,i.jsxs)(n.li,{children:["The statement within the loop is executed (",(0,i.jsx)(n.code,{children:"Write(array[i])"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Finally, the increment expression will evaluate (",(0,i.jsx)(n.code,{children:"i++"}),")."]}),"\n",(0,i.jsx)(n.li,{children:"The loop goes back to step 2 until it is false."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"To optimize speed, cache the length used for condition. By assigning it to a variable in initial expression, the loop won't have to calculate the length on each iteration."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'{1} title="Initial expression assigns array.length to a variable to cache it"',children:"for (var i = 0, range = array.length; i < range; i++) {\n    Write(i);                           // Returns the current iteration\n    Write(array[i] + '<br/><br/>');     // Returns the value of current element\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You can get more logic within the ",(0,i.jsx)(n.code,{children:"for"})," declaration to, for example, have a cleaner statement within the loop:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'{1} title="Provide itemValue variable instead of just current iteration"',children:"for (var i = 0, itemValue = array[i], range = array.length; i < range; i++, itemValue = array[i]) {\n    Write(itemValue + '<br/><br/>');    // Returns the value of current element\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["As ES6 ",(0,i.jsx)(n.a,{href:"/docs/js/js-loops#for-of",children:"for...of"})," loop is not available in SSJS, you will use this one in most scenarios."]}),"\n",(0,i.jsx)(n.h3,{id:"for-in",children:"For in"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"for...in"})," loop in modern JavaScript is used nearly exclusively for debugging. It is because it loops not only over standard values but also over object prototype methods and properties."]}),"\n",(0,i.jsxs)(n.p,{children:["In SSJS however, the ES6 ",(0,i.jsx)(n.a,{href:"/docs/js/js-loops#for-of",children:"for...of"})," loop is not available. ",(0,i.jsx)(n.code,{children:"Object.keys()"})," or ",(0,i.jsx)(n.code,{children:"Object.entries()"})," also does not exist. This makes the ",(0,i.jsx)(n.code,{children:"for...in"})," the only solution for iterating over objects."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:"{1}",children:"for (var key in object) {\n    Write(key + '<br/><br/>');          // Returns string name of the current key\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In simple scripts created in SSJS you shouldn't have issues with the prototype methods and properties, however, if you encounter any issues (or want to code defensively), use ",(0,i.jsx)(n.code,{children:"hasOwnProperty"})," method:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:"{2}",children:"for (var key in object) {\n    if (object.hasOwnProperty(key) && key != '_type') {\n        Write(key + '<br/><br/>');\n    };\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Remember to use ",(0,i.jsx)(n.code,{children:"for...in"})," only for looping over objects. For any other scenario classic ",(0,i.jsx)(n.code,{children:"for"})," loop is both safer and more powerful."]}),"\n",(0,i.jsx)(n.admonition,{title:"You Should Know",type:"note",children:(0,i.jsxs)(n.p,{children:["If you ever use ",(0,i.jsx)(n.code,{children:"for...in"})," loop for an array, remember that the loop-counter variable will return a string instead of a number. For example ",(0,i.jsx)(n.code,{children:"'0'"})," for first array item instead of ",(0,i.jsx)(n.code,{children:"0"}),"."]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"while-loops",children:"While Loops"}),"\n",(0,i.jsx)(n.h3,{id:"while",children:"While"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.code,{children:"while"})," loop executes its statement as long as the condition evaluates to true."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'{2} title="Infinite while loop"',children:"var run = true;\nwhile (run === true) {\n    Write('To the infinity and beyond!');\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To break out of ",(0,i.jsx)(n.code,{children:"while"})," loop, there must be logic within it that will change the condition to false (or a ",(0,i.jsx)(n.code,{children:"break"})," statement):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:"{3}",children:"var run = true;\nvar i = 0;\nwhile (run === true) {\n    Write('To the infinity and beyond!');\n    i++;\n    if (i > 10) {\n        run = false;\n    };\n};\n"})}),"\n",(0,i.jsx)(n.p,{children:"or just:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'{3} title="This loop has the same outcome as the one above"',children:"var run = true;\nvar i = 0;\nwhile (i <= 10) {\n    Write('To the infinity and beyond!');\n    i++;\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"while"})," loop is the best option for iterating over ",(0,i.jsx)(n.strong,{children:"big"})," arrays."]}),"\n",(0,i.jsx)(n.h3,{id:"do-while",children:"Do While"}),"\n",(0,i.jsxs)(n.p,{children:["Same as ",(0,i.jsx)(n.code,{children:"while"}),", but the code runs once before evaluating the condition."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:"{1,3}",children:"do {\n    Write('Running!');\n} while (run === true);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Perfect when you need to run an API call, check whether there are more pages of outcomes and act accordingly."}),"\n",(0,i.jsxs)(n.admonition,{title:"You Should Know",type:"note",children:[(0,i.jsxs)(n.p,{children:["JavaScript support labels for loops. It allows you to name each loop for even better control with both ",(0,i.jsx)(n.code,{children:"continue"})," and ",(0,i.jsx)(n.code,{children:"break"})," statements."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'{1,8} title="Labelled loop example using a nested for loops"',children:"MainLoopLabel:\nfor (var i = 0; i < array.length; i++) {\n    // Logic\n    SecondaryLoopLabel:\n    for (var j = 0; j < array[i].length; j++) {\n        // Logic\n        if (array[i][j] === 'important') {\n            break MainLoopLabel;\n        };\n    };\n};\n"})}),(0,i.jsxs)(n.p,{children:["As you can see, in the first line we added a label for the first ",(0,i.jsx)(n.code,{children:"for"})," loop. Then, in the statement within the second ",(0,i.jsx)(n.code,{children:"for"})," loop, we used ",(0,i.jsx)(n.code,{children:"break"})," followed by the label. Once executed, it will break both for loops, even if there were still iterations in the main one. The same approach works with the ",(0,i.jsx)(n.code,{children:"continue"})," statement."]})]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},6748:(e,n,o)=>{o.d(n,{U:()=>t});const i="leadText_qzwo";var s=o(4848);const t=e=>{let{content:n}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("p",{id:i,children:n})})}},8453:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>l});var i=o(6540);const s={},t=i.createContext(s);function r(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);