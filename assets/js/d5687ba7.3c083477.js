(self.webpackChunkmd=self.webpackChunkmd||[]).push([[87],{4137:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=d(n),m=o,h=u["".concat(l,".").concat(m)]||u[m]||c[m]||i;return n?a.createElement(h,r(r({ref:t},p),{},{components:n})):a.createElement(h,r({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var d=2;d<i;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8921:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(7294),o=n(6010),i="tableOfContentsInline_3fWc";function r(e){var t=e.toc,n=e.isChild;return t.length?a.createElement("ul",{className:n?"":"table-of-contents"},t.map((function(e){return a.createElement("li",{key:e.id},a.createElement("a",{href:"#"+e.id,dangerouslySetInnerHTML:{__html:e.value}}),a.createElement(r,{isChild:!0,toc:e.children}))}))):null}var s=function(e){var t=e.toc;return a.createElement("div",{className:(0,o.Z)(i)},a.createElement(r,{toc:t}))}},2043:function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var a=n(7294),o="leadText_16va",i=function(e){var t=e.content;return a.createElement(a.Fragment,null,a.createElement("p",{id:o},t))}},3581:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return d},contentTitle:function(){return p},metadata:function(){return c},toc:function(){return u},default:function(){return h}});var a=n(2122),o=n(9756),i=(n(7294),n(4137)),r=n(8921),s=n(2043),l=["components"],d={id:"ssjs-style-guide",title:"SSJS Style Guide",sidebar_label:"Style Guide",description:"Script with style. Readable code is a few rules & best practices away"},p=void 0,c={unversionedId:"ssjs/ssjs-style-guide",id:"ssjs/ssjs-style-guide",isDocsHomePage:!1,title:"SSJS Style Guide",description:"Script with style. Readable code is a few rules & best practices away",source:"@site/docs/ssjs/ssjs-style-guide.mdx",sourceDirName:"ssjs",slug:"/ssjs/ssjs-style-guide",permalink:"/docs/ssjs/ssjs-style-guide",editUrl:"https://github.com/MateuszDabrowski/mateuszdabrowski.pl/edit/master/docs/ssjs/ssjs-style-guide.mdx",version:"current",lastUpdatedBy:"Mateusz D\u0105browski",lastUpdatedAt:1624745933,formattedLastUpdatedAt:"6/27/2021",frontMatter:{id:"ssjs-style-guide",title:"SSJS Style Guide",sidebar_label:"Style Guide",description:"Script with style. Readable code is a few rules & best practices away"},sidebar:"snippets",previous:{title:"Debugging & Error Handling",permalink:"/docs/ssjs/debugging-ssjs"},next:{title:"Performance",permalink:"/docs/ssjs/ssjs-vs-ampscript-performance"}},u=[{value:"Naming Convention",id:"naming-convention",children:[{value:"Meaningful Names",id:"meaningful-names",children:[]},{value:"JS Variables, Functions &amp; Methods Letter Case",id:"js-variables-functions--methods-letter-case",children:[]},{value:"SSJS Functions Letter Case",id:"ssjs-functions-letter-case",children:[]}]},{value:"Alignment and Indentation",id:"alignment-and-indentation",children:[{value:"Expanded Syntax",id:"expanded-syntax",children:[]},{value:"Consistent Indentation",id:"consistent-indentation",children:[]},{value:"Intentional Spacing",id:"intentional-spacing",children:[]}]},{value:"Debatable Styles",id:"debatable-styles",children:[{value:"Semicolons",id:"semicolons",children:[]},{value:"Consistent Quotes",id:"consistent-quotes",children:[]}]},{value:"Comments",id:"comments",children:[{value:"1. Table of Contents Comment",id:"1-table-of-contents-comment",children:[]},{value:"2. Section Comments",id:"2-section-comments",children:[]},{value:"3. Documentation Comments",id:"3-documentation-comments",children:[]}]},{value:"Sum Up",id:"sum-up",children:[]}],m={toc:u};function h(e){var t=e.components,n=(0,o.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(s.m,{content:"Script with style. Readable code is a few rules & conventions away.",mdxType:"LeadText"}),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Table of Contents")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)(r.Z,{toc:u,mdxType:"TOCInline"}))),(0,i.kt)("p",null,"First things first: this Salesforce Marketing Cloud SSJS style guide is highly subjective. You may use it as it is, implement only some parts of it, or ignore it altogether. There are only two rules that I believe are a must-have:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Be consistent across your codebase."),(0,i.kt)("li",{parentName:"ol"},"Strive for good readability.")),(0,i.kt)("p",null,"Everything else is preference. And you are just about to learn about mine."),(0,i.kt)("h2",{id:"naming-convention"},"Naming Convention"),(0,i.kt)("p",null,"SSJS gives you a lot of freedom when it comes to naming and letter case. But instead of going freestyle with that flexibility, we should leverage it to build something meaningful and readable. I decided to focus also on simplicity."),(0,i.kt)("h3",{id:"meaningful-names"},"Meaningful Names"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use descriptive names to provide context.")),(0,i.kt)("p",null,"As ",(0,i.kt)("a",{parentName:"p",href:"https://groups.google.com/g/comp.lang.c++/c/rYCO5yn4lXw/m/oITtSkZOtoUJ?pli=1"},"John F. Woods")," said, ",(0,i.kt)("inlineCode",{parentName:"p"},"always code as if the guy who ends up maintaining your code will be a violent psychopath who knows where you live"),". Meaningful and consistent names are an excellent starting point for living a long (coding) life with a limited amount of frustration and regret when someone asks you about your year-old code to adapt to a new project."),(0,i.kt)("p",null,"Applying the rules listed below is easy when you write the code and remember its logic but can be a challenge after resetting your memory by writing few other scripts. Make your SSJS better with meaningful variable and function names."),(0,i.kt)("h4",{id:"variable-names"},"Variable Names"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Use descriptive variable names. It is better to have a long explicit one (",(0,i.kt)("inlineCode",{parentName:"li"},"isTrackingSuppressed"),") than a short mysterious abbreviation (",(0,i.kt)("inlineCode",{parentName:"li"},"trk"),")."),(0,i.kt)("li",{parentName:"ol"},"When the variable is a boolean, prefix it with ",(0,i.kt)("inlineCode",{parentName:"li"},"is")," (or ",(0,i.kt)("inlineCode",{parentName:"li"},"has"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"does"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"are")," depending on the underlying data)."),(0,i.kt)("li",{parentName:"ol"},"When the variable is a date, suffix it with ",(0,i.kt)("inlineCode",{parentName:"li"},"Date"),"."),(0,i.kt)("li",{parentName:"ol"},"When the variable is an array, use a plural name (",(0,i.kt)("inlineCode",{parentName:"li"},"optIns"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"favouriteProductCategories"),").")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Descriptive and suggesting boolean data type */\nvar isTrackingSuppressed = false;\n\n/* \u274c Name neither describes the variable purpose nor suggest its data type */\nvar value = false;\n\n/* \u2705 Descriptive and suggesting date data type */\nvar trackingSupressionStartDate = new Date();\n\n/* \u274c Name neither describes the variable purpose nor suggest its data type */\nvar supressed = new Date();\n")),(0,i.kt)("h4",{id:"function-names"},"Function Names"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Use descriptive function names. It is better to have a long explicit one (",(0,i.kt)("inlineCode",{parentName:"li"},"getEmailAddress"),") than a short mysterious abbreviation (",(0,i.kt)("inlineCode",{parentName:"li"},"geteml"),"). Think how you can add as much information as possible, without adding unnecessary bits (",(0,i.kt)("inlineCode",{parentName:"li"},"lookupContactBySubscriberKey")," vs ",(0,i.kt)("inlineCode",{parentName:"li"},"lookupAvailableContactBySubscriberKeyFromDataExtension"),")."),(0,i.kt)("li",{parentName:"ol"},"Use a verb (",(0,i.kt)("inlineCode",{parentName:"li"},"get"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"post"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"update"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"send"),") as the first part of the name to tell what the function is doing."),(0,i.kt)("li",{parentName:"ol"},"Apply ",(0,i.kt)("a",{parentName:"li",href:"#variable-names"},"variable naming rules")," to the parameters - leave single-letter names for minifiers.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Both function name and parameters are descriptive */\nfunction debugValue(description, value) {\n    Write(description + ': ' + (typeof value == 'object' ? Stringify(value) : value) + '<br><br>');\n};\n\n/* \u274c Neither function name nor parameters are descriptive */\nfunction write(d, v) {\n    Write(d + ': ' + (typeof v == 'object' ? Stringify(v) : v) + '<br><br>');\n};\n")),(0,i.kt)("h3",{id:"js-variables-functions--methods-letter-case"},"JS Variables, Functions & Methods Letter Case"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use ",(0,i.kt)("inlineCode",{parentName:"strong"},"camelCase")," for all elements of JS syntax.")),(0,i.kt)("p",null,"The first category of the building blocks in your code will be JavaScript (ECMAScript 3 in case of SSJS) native elements. Variables (",(0,i.kt)("inlineCode",{parentName:"p"},"var")," only), functions (no array goodies), and methods."),(0,i.kt)("p",null,"For all of those I'm using ",(0,i.kt)("inlineCode",{parentName:"p"},"camelCase"),". It's the most popular convetion, so it will make it easier to work with other programmers, leverage code snippets and onboard new-to-SSJS people to SFMC development."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 camelCase for JS syntax */\nvar variableName = 'Hello World';\nfunction functionName(variableName) {\n    return variableName.toLowerCase();\n};\n\n/* \u274c Random case */\nvar VARIABLENAME = 'Hello World';\nfunction FunctionName(variableName) {\n    return variableName.tolowercase();\n};\n")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"You Should Know")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"JavaScript variables are case sensitive. ",(0,i.kt)("inlineCode",{parentName:"p"},"Name")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," are two different variables that can have different values, so it's critically important to have a stable convention."))),(0,i.kt)("h3",{id:"ssjs-functions-letter-case"},"SSJS Functions Letter Case"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use ",(0,i.kt)("inlineCode",{parentName:"strong"},"PascalCase")," for all elements of SSJS syntax.")),(0,i.kt)("p",null,"I take a different approach when working with SSJS Functions from both Platform and Core libraries. For any element coming from those, I use ",(0,i.kt)("inlineCode",{parentName:"p"},"PascalCase"),"."),(0,i.kt)("p",null,"Not only it allows to differentiate JavaScript native and SFMC custom elements, but it also follows the official SSJS documentation (and therefore most of the snippets you might find)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 PamelCase for JS syntax */\nPlatform.Load('Core', '1');\nvar dataExtension = DataExtension.Retrieve({\n    Property: 'CustomerKey',\n    SimpleOperator: 'equals',\n    Value: 'dataExtensionExternalKey'\n});\n\n/* \u274c Random case */\nPLATFORM.LOAD('Core', '1');\nvar dataExtension = dataextensions.retrieve({\n    Property: 'CustomerKey',\n    SimpleOperator: 'equals',\n    Value: 'dataExtensionExternalKey'\n});\n")),(0,i.kt)("h2",{id:"alignment-and-indentation"},"Alignment and Indentation"),(0,i.kt)("p",null,"Letter case is just one element of syntax convention that helps with readability. Another huge one is alignment and indentation. JavaScript requires neither, but both can help you write better code."),(0,i.kt)("h3",{id:"expanded-syntax"},"Expanded Syntax"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Sparse is better than dense.")),(0,i.kt)("p",null,"Readability counts. Having fewer lines is not worth the mental gymnastics required to read a condensed code. It is also much easier to find unclosed brackets."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Expanded Variable Syntax */\nvar debugging = {\n    request: true,\n    response: true,\n    error: true\n};\n\n/* \u274c Condensed Variable Syntax */\nvar debugging = { request: true, response: true, error: true };\n\n/* \u2705 Expanded Function Syntax */\nfunction debugValue(description, value) {\n    Write(description + ': ' + (typeof value == 'object' ? Stringify(value) : value) + '<br><br>');\n};\n\n/* \u274c Condensed Function Syntax */\nfunction debugValue(description, value) { Write(description + ': ' + (typeof value == 'object' ? Stringify(value) : value) + '<br><br>'); };\n\n/* \u2705 Expanded Try/Catch Syntax */\ntry {\n    var response = HTTP.Get('http://www.example.c');\n} catch (error) {\n    handleError(error);\n};\n\n/* \u274c Condensed Try/Catch Syntax */\ntry { var response = HTTP.Get('http://www.example.c'); } catch (error) { handleError(error); };\n")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"You Should Know")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"I have two exceptions to this rule - both related to ",(0,i.kt)("inlineCode",{parentName:"p"},"if")," statement shorthands."),(0,i.kt)("ol",{parentName:"div"},(0,i.kt)("li",{parentName:"ol"},"Ternary operator")),(0,i.kt)("p",{parentName:"div"},"Ternary simplifies basic ",(0,i.kt)("inlineCode",{parentName:"p"},"if"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"else")," statements, and when used correctly, it should be readable in a single line. If you fear it might be hard to understand, you probably shouldn't use the ternary operator in the first place."),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Condensed Ternary Syntax */\ntypeof value == 'object' ? Stringify(value) : value;\n\n/* \u274c Expanded Ternary Syntax */\ntypeof value == 'object'\n    ? Stringify(value)\n    : value;\n\n/* \u274c Too Complex for Ternary Syntax */\ndebugging ? debugValue(error) : Platform.Function.InsertData('Data_Extension_Name', ['id', 'errorSource', 'errorMessage', 'errorDescription'], [GUID(), 'Name of the place where the script runs', Stringify(error.message), Stringify(error.description)]);\n")),(0,i.kt)("ol",{parentName:"div",start:2},(0,i.kt)("li",{parentName:"ol"},"Single line ",(0,i.kt)("inlineCode",{parentName:"li"},"if")," statements.")),(0,i.kt)("p",{parentName:"div"},"Similarly to ternary, single-line if statements also should be used only for basic ",(0,i.kt)("inlineCode",{parentName:"p"},"if")," statements. Whenever there is any complexity (be it ",(0,i.kt)("inlineCode",{parentName:"p"},"else")," statement or just a longer case body), I always go with the expanded syntax."),(0,i.kt)("pre",{parentName:"div"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Condensed Shorthand If Syntax */\nif (debugging) debugValue(error);\n\n/* \u2705 Expanded Standard If Syntax */\nif (debugging) {\n    debugValue(error);\n} else {\n    Platform.Function.InsertData('Data_Extension_Name', ['id', 'errorSource', 'errorMessage', 'errorDescription'], [GUID(), 'Name of the place where the script runs', Stringify(error.message), Stringify(error.description)]);\n};\n\n/* \u274c Too Complex for Shorthand If Syntax */\nif (response.StatusCode == 200) { var parsedResponse = Platform.Function.ParseJSON(String(response.Response)); if (!parsedResponse.success) throw 'Wrong reCAPTCHA'; };\n")),(0,i.kt)("p",{parentName:"div"},"It's up to you to decide how complex is too complex. Whenever in doubt - use expanded syntax."))),(0,i.kt)("h3",{id:"consistent-indentation"},"Consistent Indentation"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use indentation to highlight code relationships.")),(0,i.kt)("p",null,"This rule extends the expanded syntax guide. Don't stop at expanding. Indent. It will help you quickly understand the relationships between the code lines."),(0,i.kt)("p",null,"The easy way to implement correct identation is to add a level whenever you open curly bracket and remove one whenever you close it. However, sometimes readability can be improved with even more identation, for example within expanded array."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Indented Syntax */\nfor (var i = 0; i < response.length - 1; i++) {\n    var responseRowData = response[i].split(',');\n    campaignData.push({\n        name: responseRowData[0],\n        id: responseRowData[1],\n        startDate: responseRowData[2],\n        endDate: responseRowData[3]\n    });\n};\n\n/* \u274c Flat Syntax */\nfor (var i = 0; i < response.length - 1; i++) {\nvar responseRowData = response[i].split(',');\ncampaignData.push({\nname: responseRowData[0],\nid: responseRowData[1],\nstartDate: responseRowData[2],\nendDate: responseRowData[3]\n});\n};\n")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"You Should Know")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It's safer to use spaces instead of tabs for indentation. And it's more readable to use four spaces instead of two. You can configure your code editor to output four spaces on each Tab click."))),(0,i.kt)("h3",{id:"intentional-spacing"},"Intentional Spacing"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use spaces wherever it makes the code more readable.")),(0,i.kt)("p",null,"To visually separate elements, use spaces:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Around operators."),(0,i.kt)("li",{parentName:"ul"},"Before opening curly bracket and after closing curly bracket."),(0,i.kt)("li",{parentName:"ul"},"After commas."),(0,i.kt)("li",{parentName:"ul"},"After keywords (",(0,i.kt)("inlineCode",{parentName:"li"},"if"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"while"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"function"),", etc.).")),(0,i.kt)("p",null,"To provide important context, don't add spaces:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"After opening and before closing non-curly brackets."),(0,i.kt)("li",{parentName:"ul"},"Between function name and arguments.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Intentional spacing */\nif (response.StatusCode != 200) {\n    throw {'message': 'HTTP.Get Error', 'description': 'Could not connect to example.com'}\n};\n\n/* \u274c Lack of spacing */\nif(response.StatusCode!=200){\n    throw{'message':'HTTP.Get Error','description':'Could not connect to example.com'}\n};\n\n/* \u2705 Intentional spacing */\nfunction debugValue(description, value) {\n    Write(description + ': ' + (typeof value == 'object' ? Stringify(value) : value) + '<br><br>');\n};\n\n/* \u274c Wrong spacing */\nfunction debugValue ( description, value ) {\n    Write ( description + ': ' + ( typeof value == 'object' ? Stringify( value ) : value ) + '<br><br>' );\n};\n")),(0,i.kt)("h2",{id:"debatable-styles"},"Debatable Styles"),(0,i.kt)("p",null,"Apart from letter case and indentation, some additional style rules are important to consider. Multiple arguments favour various conventions, so feel free not to follow my recommendation as long as you stay consistent across your code."),(0,i.kt)("h3",{id:"semicolons"},"Semicolons"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Add a semicolon after each statement.")),(0,i.kt)("p",null,"The semicolons in JavaScript are optional. You can do without them entirely. But I prefer to use them. Why?"),(0,i.kt)("p",null,"If you do not use semicolons, JS will add them for you using Automatic Semicolon Injection (ASI). In most cases, it works perfectly, but there might be some situations where the outcome is not what you expected. And that will lead to a very long and frustrating debugging session. If you want to think about ASI when writing, you may ignore semicolons."),(0,i.kt)("p",null,"If you don't want to worry about ASI, per JS language specification, you should:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Mark the end of your simple statements with a semicolon ",(0,i.kt)("inlineCode",{parentName:"li"},";"),". Think variable declarations and operations."),(0,i.kt)("li",{parentName:"ul"},"Don't end complex statements with a semicolon. Think ",(0,i.kt)("a",{parentName:"li",href:"/docs/ssjs/ssjs-if-and-switch#if-statements"},(0,i.kt)("inlineCode",{parentName:"a"},"if"))," statements, ",(0,i.kt)("a",{parentName:"li",href:"/docs/ssjs/ssjs-loops"},"loops"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"functions"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"try/catch")," blocks."),(0,i.kt)("li",{parentName:"ul"},"But... you need a semicolon after the ",(0,i.kt)("a",{parentName:"li",href:"/docs/ssjs/ssjs-loops#do-while"},(0,i.kt)("inlineCode",{parentName:"a"},"do/while")," loop"),". Because JavaScript (and yeah, it is different from ",(0,i.kt)("a",{parentName:"li",href:"/docs/ssjs/ssjs-loops#while"},(0,i.kt)("inlineCode",{parentName:"a"},"while")," loop")," when considering the statement blocks). Oh, and you will need to add them in your ",(0,i.kt)("a",{parentName:"li",href:"/docs/ssjs/ssjs-loops#for"},(0,i.kt)("inlineCode",{parentName:"a"},"for")," loop")," iteration rules.")),(0,i.kt)("p",null,"That's also a bit to digest and worry about when writing the code. Let's simplify it."),(0,i.kt)("p",null,"While you don't ",(0,i.kt)("strong",{parentName:"p"},"need")," a semicolon after complex statements, it won't hurt. It can even help you if you plan to minify the code. So, to make it straightforward and fail-safe, I recommend adding it after each statement."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="Keep calm and spam semicolons"',title:'"Keep',calm:!0,and:!0,spam:!0,'semicolons"':!0},"/* \u2705 Semicolons everywhere */\nfor (var i = 0; i < response.length - 1; i++) {\n    var responseRowData = response[i].split(',');\n    campaignData.push({\n        name: responseRowData[0],\n        id: responseRowData[1],\n        startDate: responseRowData[2],\n        endDate: responseRowData[3]\n    });\n};\n\n/* \u274c No semicolons - this will crash due to no semicolons between for iteration rules */\nfor (var i = 0 i < response.length - 1  i++) {\n    var responseRowData = response[i].split(',')\n    campaignData.push({\n        name: responseRowData[0],\n        id: responseRowData[1],\n        startDate: responseRowData[2],\n        endDate: responseRowData[3]\n    })\n}\n")),(0,i.kt)("h3",{id:"consistent-quotes"},"Consistent Quotes"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Use single quote style.")),(0,i.kt)("p",null,"With SSJS, you can use either single quotes (",(0,i.kt)("inlineCode",{parentName:"p"},"'"),") or double quotes (",(0,i.kt)("inlineCode",{parentName:"p"},'"'),"). Don't follow the random approach of Salesforce SSJS documentation - choose one and be consistent."),(0,i.kt)("p",null,"I prefer single quotes for SSJS:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"I frequently use string variables with HTML that uses double quotes. Using single quotes in SSJS means no need to escape the ones in HTML."),(0,i.kt)("li",{parentName:"ol"},"On most keyboard (including mine), it doesn't require pressing Shift each time. Clicking one button is faster.")),(0,i.kt)("p",null,"However, there are also arguments for double quotes:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"There are many English words using apostrophes, and using double quotes means no need to escape them."),(0,i.kt)("li",{parentName:"ol"},"JSON requires double quotes.")),(0,i.kt)("p",null,"In the end, pick one, align with your team, and stay consistent. Yes, this means updating quotes after copy-pasting from Stack Overflow. RegEx is your friend ;)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* \u2705 Single Quotes */\nif (response.StatusCode != 200) {\n    throw {'message': 'HTTP.Get Error', 'description': 'Could not connect to example.com'};\n};\n\n/* \u2705 Double Quotes */\nif (response.StatusCode != 200) {\n    throw {\"message\": \"HTTP.Get Error\", \"description\": \"Could not connect to example.com\"};\n};\n\n/* \u274c Mixed Quotes */\nif (response.StatusCode != 200) {\n    throw {'message': \"HTTP.Get Error\", 'description': \"Could not connect to example.com\"};\n};\n")),(0,i.kt)("h2",{id:"comments"},"Comments"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Code tells you how. Comments tell you why.")," - ",(0,i.kt)("a",{parentName:"p",href:"https://blog.codinghorror.com/code-tells-you-how-comments-tell-you-why/"},"Jeff Atwood")),(0,i.kt)("p",null,"To make your code better, don't stop at just the code. Leverage comments to their full potential. Context, logic and caveats description will improve the experience for everyone - including you after few weeks."),(0,i.kt)("p",null,"Whenever you build more complex SSJS code, I recommend using at least three types of comments: table of contents, section and documentation. For short scripts, the last type will be enough."),(0,i.kt)("h3",{id:"1-table-of-contents-comment"},"1. Table of Contents Comment"),(0,i.kt)("p",null,"The first type of comment you should use at the top of your longer scripts is the table of contents comment. This one will be your best friend during the whole lifecycle of your script."),(0,i.kt)("p",null,"Before even starting to write SSJS, describe the desired outcome and steps you plan to code to get there. It can be high level; it can be a draft. But it will help you focus on the best way to write your script and consider potential roadblocks or opportunities for optimisation."),(0,i.kt)("p",null,"As you are building your script - update the comment to reflect the approach you took. It will help you assess the impact of potential changes and find missing pieces."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* ---------------------------------------------------------------------\n\nAuthenticates each visitor to limit access only to SFMC logged-in users.\n\n1. Global Variables - should be updated for each implementation\n2. Helper Functions\n2.1. Error handling\n3. Authentication Flow\n3.1. Authorisation\n3.2. Authentication with REST Token\n3.2.1. Upsert Logging Data Extension\n\n--------------------------------------------------------------------- */\n")),(0,i.kt)("h3",{id:"2-section-comments"},"2. Section Comments"),(0,i.kt)("p",null,"To fully leverage the pseudo-code table of contents, add section comments to mark where each part of your code starts."),(0,i.kt)("p",null,"For complex scripts, it might be a good idea to create few different levels of such comments. I use upper case with dashes for the first level, title case with dashes for the second level and only title case for the third level of comments"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/* ---------------------- 1. GLOBAL VARIABLES ----------------------- */\n\n/* ---------------------- 2. HELPER FUNCTIONS ----------------------- */\n\n/* ---------------------- 2.1. Error handling ----------------------- */\n\n/* ---------------------- 3. AUTHENTICATION FLOW -------------------- */\n\n/* ---------------------- 3.1. Authorisation ------------------------ */\n\n/* ---------------------- 3.2. Authentication ----------------------- */\n\n/* 3.2.1. Build token request payload */\n")),(0,i.kt)("h3",{id:"3-documentation-comments"},"3. Documentation Comments"),(0,i.kt)("p",null,"Two previous comment types are suitable for high-level view and organisation of your more complex scripts. But the essential type of comment is the one that goes into detail about the implementation - the documentation comments."),(0,i.kt)("p",null,"You should use one for every custom function you create, but it might also benefit variables (especially those with values coming from an API response). Rule of thumb - add them whenever someone else reading your code for the first time would ask a question about context or purpose."),(0,i.kt)("p",null,"I recommend using ",(0,i.kt)("a",{parentName:"p",href:"https://jsdoc.app/index.html"},"JSDoc")," for few reasons:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"It's a popular standard."),(0,i.kt)("li",{parentName:"ol"},"It provides recommendations on what to add to the comment."),(0,i.kt)("li",{parentName:"ol"},"Many code editors will help you write it and highlight its syntax."),(0,i.kt)("li",{parentName:"ol"},"Marketing Cloud ecosystem already leverages it in Interaction Studio.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"/**\n * @function debugValue\n * @description Outputs provided description and SSJS value to front-end in a type-safe & consistent way\n * @param {string} description - Describes meaning of the second parameter in the output\n * @param {*} value - The value that needs to be debugged\n */\nfunction debugValue(description, value) {\n    Write(description + ': ' + (typeof value == 'object' ? Stringify(value) : value) + '<br><br>');\n};\n\n/**\n * ClientID of SFMC Installed Package required for API calls\n * @type {string}\n * @const\n */\nvar clientID = 'CLIENT_ID';\n\n/**\n * Authentication GUID passed as a query string through SSO redirect\n * @type {string}\n */\nvar state = Platform.Request.GetQueryStringParameter('state');\n")),(0,i.kt)("p",null,"If you find it too complex, feel free to make it simpler, as long as your approach:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"describes context and purpose and"),(0,i.kt)("li",{parentName:"ol"},"is consistent across the codebase.")),(0,i.kt)("h2",{id:"sum-up"},"Sum Up"),(0,i.kt)("p",null,"It is a long article, so let's gather all the recommendations in one place:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Be consistent"),(0,i.kt)("li",{parentName:"ol"},"Strive for readability"),(0,i.kt)("li",{parentName:"ol"},"Use descriptive names to provide context ",(0,i.kt)("a",{parentName:"li",href:"#meaningful-names"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Use ",(0,i.kt)("inlineCode",{parentName:"li"},"camelCase")," for all elements of JS syntax ",(0,i.kt)("a",{parentName:"li",href:"#js-variables-functions--methods-case"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Use ",(0,i.kt)("inlineCode",{parentName:"li"},"PascalCase")," for all elements of SSJS syntax ",(0,i.kt)("a",{parentName:"li",href:"#ssjs-functions-case"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Sparse is better than dense ",(0,i.kt)("a",{parentName:"li",href:"#expanded-syntax"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Use indentation to highlight code relationships ",(0,i.kt)("a",{parentName:"li",href:"#consistent-indentation"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Use spaces wherever it makes the code more readable ",(0,i.kt)("a",{parentName:"li",href:"#intentional-spacing"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Add a semicolon after each statement ",(0,i.kt)("a",{parentName:"li",href:"#semicolons"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Use single quote style ",(0,i.kt)("a",{parentName:"li",href:"#consistent-quotes"},"\ud83d\udd17")),(0,i.kt)("li",{parentName:"ol"},"Use comments to provide required context to your script ",(0,i.kt)("a",{parentName:"li",href:"#comments"},"\ud83d\udd17"))),(0,i.kt)("p",null,"If you want to share something I'm missing or have arguments for a different recommendation - ",(0,i.kt)("a",{parentName:"p",href:"https://www.linkedin.com/in/mateusz-dabrowski-marketing/"},"let me know"),"."),(0,i.kt)("p",null,"Looking for more Marketing Cloud style? Check out my:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/ampscript/ampscript-style-guide"},"AMPScript Style Guide")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/docs/sql/sfmc-sql-style-guide"},"SFMC SQL Style Guide"))))}h.isMDXComponent=!0},6010:function(e,t,n){"use strict";function a(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function o(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(o&&(o+=" "),o+=t);return o}n.d(t,{Z:function(){return o}})}}]);