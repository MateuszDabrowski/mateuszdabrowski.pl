"use strict";(self.webpackChunkmd=self.webpackChunkmd||[]).push([[7768],{4137:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=o.createContext({}),l=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=l(e.components);return o.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=l(n),u=a,h=d["".concat(p,".").concat(u)]||d[u]||m[u]||r;return n?o.createElement(h,i(i({ref:t},c),{},{components:n})):o.createElement(h,i({ref:t},c))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<r;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1872:function(e,t,n){n.d(t,{m:function(){return r}});var o=n(7294),a="leadText_qzwo",r=function(e){var t=e.content;return o.createElement(o.Fragment,null,o.createElement("p",{id:a},t))}},5744:function(e,t,n){n.r(t),n.d(t,{assets:function(){return m},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return p},metadata:function(){return c},toc:function(){return d}});var o=n(7462),a=n(3366),r=(n(7294),n(4137)),i=n(1872),s=["components"],p={id:"js-snippet-export-import-document-sfmc-roles",title:"Export, Import & Document SFMC Roles",sidebar_label:"Export, Import & Document SFMC Roles",description:"Backup, clone, and move cross-account the Salesforce Marketing Cloud roles. In seconds.",image:"img/og/og-image-js-export-import-document-sfmc-roles.png",tags:["JavaScript","Marketing Cloud","Configuration","Users","Setup"]},l=void 0,c={unversionedId:"js/js-snippet-export-import-document-sfmc-roles",id:"js/js-snippet-export-import-document-sfmc-roles",title:"Export, Import & Document SFMC Roles",description:"Backup, clone, and move cross-account the Salesforce Marketing Cloud roles. In seconds.",source:"@site/docs/js/js-snippet-export-import-document-sfmc-roles.mdx",sourceDirName:"js",slug:"/js/js-snippet-export-import-document-sfmc-roles",permalink:"/docs/js/js-snippet-export-import-document-sfmc-roles",editUrl:"https://github.com/MateuszDabrowski/mateuszdabrowski.pl/edit/master/docs/js/js-snippet-export-import-document-sfmc-roles.mdx",tags:[{label:"JavaScript",permalink:"/docs/tags/java-script"},{label:"Marketing Cloud",permalink:"/docs/tags/marketing-cloud"},{label:"Configuration",permalink:"/docs/tags/configuration"},{label:"Users",permalink:"/docs/tags/users"},{label:"Setup",permalink:"/docs/tags/setup"}],version:"current",lastUpdatedBy:"Mateusz D\u0105browski",lastUpdatedAt:1650233745,formattedLastUpdatedAt:"4/18/2022",frontMatter:{id:"js-snippet-export-import-document-sfmc-roles",title:"Export, Import & Document SFMC Roles",sidebar_label:"Export, Import & Document SFMC Roles",description:"Backup, clone, and move cross-account the Salesforce Marketing Cloud roles. In seconds.",image:"img/og/og-image-js-export-import-document-sfmc-roles.png",tags:["JavaScript","Marketing Cloud","Configuration","Users","Setup"]},sidebar:"snippets",previous:{title:"\xbb JS Snippets",permalink:"/docs/category/-js-snippets"},next:{title:"AMPScript",permalink:"/docs/category/ampscript"}},m={},d=[{value:"Where the magic happens",id:"where-the-magic-happens",level:2}],u={toc:d};function h(e){var t=e.components,n=(0,a.Z)(e,s);return(0,r.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(i.m,{content:"Backup, clone, and move cross-account the Salesforce Marketing Cloud roles. In seconds.",mdxType:"LeadText"}),(0,r.kt)("p",null,"While you get a set of standard user Roles in Salesforce Marketing Cloud, those are rarely enough. Instead, they are the base on which you can create custom-tailored solutions that align with your business architecture."),(0,r.kt)("p",null,"On top of that, standard Roles are silently changing from release to release as permissions come and go, so keeping track of them is crucial to have a clear picture of what your users can do."),(0,r.kt)("p",null,"Marketing Cloud doesn't make it easy. There is no option to clone existing Roles to serve as a starting point for a new custom one. There is no option to export and import them between SFMC accounts. There is no option to create good documentation on them (unless you have a kink for super long print screens)."),(0,r.kt)("p",null,"Here comes JavaScript and ",(0,r.kt)("a",{parentName:"p",href:"/docs/js/js-dom"},"Document Object Model (DOM)")," to unlock all those scenarios."),(0,r.kt)("p",null,"Fear not - you don't have to be a developer to leverage it. I will describe everything step-by-step and share ready-to-use snippets with you. Let's dive in."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"You Should Know")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If you want to learn more about:"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"standard vs custom roles,"),(0,r.kt)("li",{parentName:"ul"},"permission overlap logic,"),(0,r.kt)("li",{parentName:"ul"},"the meaning behind their sometimes very cryptic names")),(0,r.kt)("p",{parentName:"div"},"Check out my ",(0,r.kt)("a",{parentName:"p",href:"/docs/config/sfmc-config-permissions"},"article on SFMC Permissions"),"."))),(0,r.kt)("h2",{id:"where-the-magic-happens"},"Where the magic happens"),(0,r.kt)("p",null,"To start using those SFMC Role-related, ",(0,r.kt)("a",{parentName:"p",href:"/docs/js/js-dom"},"DOM"),"-fueled solutions:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Go to Marketing Cloud Setup \xbb Users \xbb Roles."),(0,r.kt)("li",{parentName:"ol"},"Click on the name of the Role you want to work with."),(0,r.kt)("li",{parentName:"ol"},"Click the ",(0,r.kt)("inlineCode",{parentName:"li"},"expand all")," Button to see the whole permission tree for the Role."),(0,r.kt)("li",{parentName:"ol"},"Right-click any permission name within that tree and select ",(0,r.kt)("inlineCode",{parentName:"li"},"Inspect Element"),"."),(0,r.kt)("li",{parentName:"ol"},"This will open a Developer Console in a new part of your browser. Select the Console tab."),(0,r.kt)("li",{parentName:"ol"},"[Optional]"," Click the trash icon visible in the top left or right of the Console (depending on the browser you use) to clean up the working space."),(0,r.kt)("li",{parentName:"ol"},"You are ready for the fun!")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"You Should Know")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If any of the solutions described later in this article doesn't work:"),(0,r.kt)("ol",{parentName:"div"},(0,r.kt)("li",{parentName:"ol"},"Inspect one of the permission names again (either with a right-click or using the aim icon visible on the top left side of the Console)."),(0,r.kt)("li",{parentName:"ol"},"If t")),(0,r.kt)("h2",{parentName:"div",id:"export--import-sfmc-roles"},"Export & Import SFMC Roles"),(0,r.kt)("p",{parentName:"div"},"The export and import solution is super helpful when you want to either clone an existing Role and make some changes or move your perfect, tried and tested custom Role to yet another Salesforce Marketing Cloud Account."),(0,r.kt)("p",{parentName:"div"},"It will require a two-step approach."),(0,r.kt)("h3",{parentName:"div",id:"exporting-an-sfmc-role"},"Exporting an SFMC Role"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("a",{parentName:"p",href:"#where-the-magic-happens"},"Access the Console")," and paste the below code:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="Export SFMC role"',title:'"Export',SFMC:!0,'role"':!0},"let permissionsExport = {};\nfor (const permission of document.querySelectorAll('input[type=\"checkbox\"]')) {\n    permissionsExport[permission.id] = permission.checked;\n};\nconsole.log(JSON.stringify(permissionsExport));\n")),(0,r.kt)("p",{parentName:"div"},"Click enter to run it."),(0,r.kt)("p",{parentName:"div"},"It will ",(0,r.kt)("a",{parentName:"p",href:"/docs/js/js-loops"},"loop")," through all the checkboxes that you can see next to the permissions, save them in a single JavaScript object and output them to the Console. Yeah, it looks awful, but that's all you need - list of checkboxes along with their status."),(0,r.kt)("p",{parentName:"div"},"Save this long text (either by highlighting and copy-pasting or by right-clicking in an empty space within the Console row and clicking ",(0,r.kt)("inlineCode",{parentName:"p"},"Copy Selected"),"). It should start with ",(0,r.kt)("inlineCode",{parentName:"p"},"{")," and end with ",(0,r.kt)("inlineCode",{parentName:"p"},"}"),"."),(0,r.kt)("h3",{parentName:"div",id:"importing-a-sfmc-role"},"Importing a SFMC Role"),(0,r.kt)("p",{parentName:"div"},"Once you have your Role export saved, go to the new Role. It can be either an existing Role you want to overwrite or a new Role (in the same or different SFMC account)."),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("a",{parentName:"p",href:"#where-the-magic-happens"},"Access the Console")," and paste the below code:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'{1} title="Import SFMC role"',"{1}":!0,title:'"Import',SFMC:!0,'role"':!0},"let permissionsImport = {}; // replace {} with the object copied from Export script output\nfor (const [permissionId, permissionStatus] of Object.entries(permissionsImport)) {\n    document.getElementById(permissionId).checked = permissionStatus;\n}\n")),(0,r.kt)("p",{parentName:"div"},"Change the ",(0,r.kt)("inlineCode",{parentName:"p"},"{}")," in the first line with the export text you saved and click enter to run it."),(0,r.kt)("p",{parentName:"div"},"It will ",(0,r.kt)("a",{parentName:"p",href:"/docs/js/js-loops"},"loop")," through all the saved checkboxes and update their state to the one from your export. If some new checkboxes don't exist in the export (for example, you did your export before Marketing Cloud Release that added some new permissions), those new ones will stay unchanged."),(0,r.kt)("p",{parentName:"div"},"That's it. You cloned a Role."),(0,r.kt)("p",{parentName:"div"},"Now, as you can see, the export text was not readable. If you don't want to clone a Role but rather create documentation for it, there is yet another script that is just as easy to use."),(0,r.kt)("h2",{parentName:"div",id:"document-sfmc-roles"},"Document SFMC Roles"),(0,r.kt)("p",{parentName:"div"},"Documenting Roles and Permissions is not easy. You cannot just copy-paste what you see, the HTML is a mess, and the indented names are not unique. Sure, you can print screen it, but that's a lot of checkboxes. And such images aren't accessible documentation. There must be a better way."),(0,r.kt)("p",{parentName:"div"},"And there is, so ",(0,r.kt)("a",{parentName:"p",href:"#where-the-magic-happens"},"access the Console")," and paste the below code:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'{24} title="Create documentation of your SFMC role"',"{24}":!0,title:'"Create',documentation:!0,of:!0,your:!0,SFMC:!0,'role"':!0},"let permissions = {};\n/* Loop through all permission checkboxes to get their name and state */\nfor (const permission of document.querySelectorAll('input[type=\"checkbox\"]')) {\n    /* Get the lowest-level permission name */\n    let permissionName = permission.closest('tr').querySelector('div.PermissionNameText').innerText;\n\n    /* Loop through all levels of permissions to build full path for each permission */\n    let permissionContainer = permission.closest('table');\n    do {\n        permissionContainer = permissionContainer.parentElement.previousElementSibling;\n        let permissionParentName = permissionContainer?.querySelector('div.PermissionNameText')?.innerText;\n        if (permissionParentName) permissionName = `${permissionParentName} - ${permissionName}`;\n    } while (permissionContainer && permissionContainer.id !== 'RolePanel');\n\n    /* Differentiate between Allowed and Denied checkboxes */\n    let permissionType = permission.id.startsWith('a') ? 'Allowed' : 'Denied';\n\n    /* Insert permission state into permissions object */\n    if (!permissions[permissionName]) permissions[permissionName] = {};\n    permissions[permissionName][permissionType] = permission.checked;\n};\n\n/* Output permissions in documentation-friendly format (CSV) */\nconst delimiter = '\\t'; // Configure prefered CSV delimiter (tab, comma, pipe, etc.)\nlet csv = `Permission${delimiter}Allowed${delimiter}Denied\\n`; // Headers\n/* Loop through permissions object to build a single string for easy copying from console to table */\nfor (const [permissionName, permissionStatus] of Object.entries(permissions)) {\n    csv += `${permissionName}${delimiter}${permissionStatus.Allowed}${delimiter}${permissionStatus.Denied}\\n`;\n};\nconsole.log(csv);\n")),(0,r.kt)("p",{parentName:"div"},"Click enter to run it."),(0,r.kt)("p",{parentName:"div"},"It will ",(0,r.kt)("a",{parentName:"p",href:"/docs/js/js-loops"},"loop")," through all the checkboxes that you can see next to the permissions and:"),(0,r.kt)("ul",{parentName:"div"},(0,r.kt)("li",{parentName:"ul"},"Save the permission name (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},"View All Contacts"),")."),(0,r.kt)("li",{parentName:"ul"},"Prefix it with all the parent permissions to get a full path (for example, ",(0,r.kt)("inlineCode",{parentName:"li"},"Contacts - Contact Builder - View All Contacts"),")."),(0,r.kt)("li",{parentName:"ul"},"Capture the state of Allow and Deny (as a boolean)."),(0,r.kt)("li",{parentName:"ul"},"Output it to the Console as a single long text with Headers and delimiter of your choice.")),(0,r.kt)("p",{parentName:"div"},"The default delimiter is a tab (",(0,r.kt)("inlineCode",{parentName:"p"},"\\t"),") because it allows you to copy-paste the outcome from Console to a spreadsheet and have it automatically populate the columns. However, depending on your needs, you can change the ",(0,r.kt)("inlineCode",{parentName:"p"},"delimiter")," variable to something else, like a comma (",(0,r.kt)("inlineCode",{parentName:"p"},","),")  or pipe (",(0,r.kt)("inlineCode",{parentName:"p"},"|"),")."),(0,r.kt)("p",{parentName:"div"},"Save this long text in its entirety (either by highlighting and copy-pasting or by right-clicking in empty space within the Console row and clicking ",(0,r.kt)("inlineCode",{parentName:"p"},"Copy Selected"),") - I recommend pushing it straight to a spreadsheet to leverage the autoformatting and filtering capabilities."),(0,r.kt)("p",{parentName:"div"},"Add the Name of the Role and its purpose stored in the Description field, and that's it. You are good to go."))))}h.isMDXComponent=!0}}]);