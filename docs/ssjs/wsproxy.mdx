---
id: wsproxy
title: WSProxy Basics
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import { LeadText } from '../../src/components/LeadText.js';

<LeadText content='Make SOAP API great again!' />

Simple Object Access Protocol is one of the most popular ways of for exchanging structured information. It's old. It's complex. It's hard to wrap head around quickly. Most of the modern web uses REST API (more about it in a minute). But SOAP is still alive in a lot of places. Salesforce Marketing Cloud included. Sort of.

As far as SFMC is still using [SOAP API](https://developer.salesforce.com/docs/atlas.en-us.mc-apis.meta/mc-apis/web_service_guide.htm "SFMC SOAP API Official Documentation"), it is in freeze mode. Not actively developed (officialy) as focus is put on extending the scope of the REST API. But right now we are in this weird transitional period, when some features of Marketing Cloud are accessible with the SOAP, some with the REST. And some with both, even when official documentation disagree (for example undocumented [Automation Endpoint](https://gortonington.com/creating-a-triggered-automation-in-sfmc-via-rest-api/ "Blog post by Gregory "Gortonigton" Gifford")). When we can expect fully RESTful SFMC? Recent launch of the WSProxy should be enough for an answer. Let's dive in why.

## WSProxy and SOAP

What is WSProxy? It's a SSJS wrapper around the bad and ugly of the SOAP API. And it is absolutely wonderful. One code comparision is worth thousand words.

<Tabs
    defaultValue='soap'
    values={[
        {label: 'SOAP API Call', value: 'soap'},
        {label: 'Standard SSJS SOAP Call', value: 'ssjs'},
        {label: 'WSProxy SOAP Call', value: 'wsproxy'},
    ]}
>
<TabItem value='soap'>

```xml title="Create an Automation with SOAP"
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                  xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                  xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing"
                  xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"
                  xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
    <soapenv:Header>
        <wsse:Security soapenv:mustUnderstand="1">
            <wsse:UsernameToken>
                <wsse:Username>username</wsse:Username>
                <wsse:Password>password</wsse:Password>
            </wsse:UsernameToken>
        </wsse:Security>
    </soapenv:Header>
    <soapenv:Body>
        <CreateRequest xmlns="http://exacttarget.com/wsdl/partnerAPI">
            <Options/>
            <Objects xsi:type="Automation">
                <Client>
                    <ID>1234567</ID>
                </Client>
                <Name>AUT_ONEOFF</Name>
                <CustomerKey>AUT_ONEOFF</CustomerKey>
                <Description>AUT_ONEOFF</Description>
                <AutomationTasks>
                    <AutomationTask>
                        <PartnerKey xsi:nil="true"/>
                        <ObjectID xsi:nil="true"/>
                        <Name>Task 1</Name>
                        <Activities>
                            <Activity>
                                <PartnerKey xsi:nil="true"/>
                                <ObjectID>c7ccca24-4567-4317-b8d0-3874d69c130c</ObjectID>
                                <Name>Query 1</Name>
                                <ActivityObject xsi:type="QueryDefinition">
                                    <PartnerKey xsi:nil="true"/>
                                    <ObjectID>c7ccca24-4567-4317-b8d0-3874d69c130c</ObjectID>
                                    <CustomerKey>546012e7-4438-4526-9e6c-5ec73939848b</CustomerKey>
                                    <Name>BrowseAbandon_US_Unica_Sendable_Audience_Approved</Name>
                                </ActivityObject>
                            </Activity>
                        </Activities>
                    </AutomationTask>
                </AutomationTasks>
                <AutomationType>scheduled</AutomationType>
            </Objects>
        </CreateRequest>
    </soapenv:Body>
</soapenv:Envelope>
```

Cleaned code sample from [official Marketing Cloud Documentation](https://developer.salesforce.com/docs/atlas.en-us.noversion.mc-apis.meta/mc-apis/interacting_with_automation_studio_via_the_web_service_soap_api.htm)

</TabItem>
<TabItem value='ssjs'>

TODO: Fix this snippet
```html
<script runat="server">
    Platform.Load("core","1");

    var Automation = Platform.Function.CreateObject("Automation");
    Platform.Function.SetObjectProperty(Automation, "Name", "AUT_ONEOFF);
    Platform.Function.SetObjectProperty(Automation, "CustomerKey", "AUT_ONEOFF);
    Platform.Function.SetObjectProperty(Automation, "Description", "AUT_ONEOFF);
    Platform.Function.SetObjectProperty(Automation, "AutomationType", "scheduled");

    var ActivityObject = Platform.Function.CreateObject("ActivityObject");
    Platform.Function.SetObjectProperty(ActivityObject, "ObjectID", "c7ccca24-4567-4317-b8d0-3874d69c130c");
    Platform.Function.SetObjectProperty(ActivityObject, "CustomerKey", "546012e7-4438-4526-9e6c-5ec73939848b");
    Platform.Function.SetObjectProperty(ActivityObject, "Name", "BrowseAbandon_US_Unica_Sendable_Audience_Approved");

    var Activity = Platform.Function.CreateObject("Activity");
    Platform.Function.SetObjectProperty(Activity, "ObjectID", "c7ccca24-4567-4317-b8d0-3874d69c130c");
    Platform.Function.SetObjectProperty(Activity, "Name", "Query 1");
    Platform.Function.SetObjectProperty(Activity, "ActivityObject", ActivityObject);

    var Activities = Platform.Function.CreateObject("Activities");
    Platform.Function.SetObjectProperty(Activities, "Activities", Activity);

    var AutomationTaskOne = Platform.Function.CreateObject("AutomationTask");
    Platform.Function.SetObjectProperty(AutomationTaskOne, "Name", "Task One");
    Platform.Function.AddObjectArrayItem(AutomationTaskOne, "Activities", ImportActivity);
    Platform.Function.AddObjectArrayItem(Automation, "AutomationTasks", AutomationTaskOne);

    var CreateRequest = Platform.Function.CreateObject("CreateRequest");
    var CreateOptions = Platform.Function.CreateObject("CreateOptions");
    Platform.Function.SetObjectProperty(CreateRequest, "Options", CreateOptions);
    Platform.Function.AddObjectArrayItem(CreateRequest, "Objects", Automation);

    var StatusAndRequestID = [0,0];
    var CreateResults = Platform.Function.InvokeCreate(CreateRequest, StatusAndRequestID);
</script>
```

</TabItem>
<TabItem value='wsproxy'>

```

```

</TabItem>
</Tabs>


Topics to cover:
What is WSProxy (no Core)
SOAP API documentation: https://developer.salesforce.com/docs/atlas.en-us.mc-apis.meta/mc-apis/web_service_guide.htm
How to translate SOAP envelope to WSProxy
Operations
- Create
- Retrieve
etc.
Item vs Batch