<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-N46LB5K"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-N46LB5K",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Mateusz DƒÖbrowski" href="/opensearch.xml"><title data-rh="true">AMPScript in SSJS | Mateusz DƒÖbrowski</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mateuszdabrowski.pl/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="author" content="Mateusz DƒÖbrowski"><meta data-rh="true" name="theme-color" content="#212121"><meta data-rh="true" name="msapplication-TileColor" content="#F6B355"><meta data-rh="true" property="og:title" content="AMPScript in SSJS | Mateusz DƒÖbrowski"><meta data-rh="true" name="description" content="Not all AMPScript functions are available in SSJS. But you still can use them."><meta data-rh="true" property="og:description" content="Not all AMPScript functions are available in SSJS. But you still can use them."><meta data-rh="true" property="og:image" content="https://mateuszdabrowski.pl/img/og/og-image-ampscript-in-ssjs.png"><meta data-rh="true" name="twitter:image" content="https://mateuszdabrowski.pl/img/og/og-image-ampscript-in-ssjs.png"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mateuszdabrowski.pl/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/"><link data-rh="true" rel="alternate" href="https://mateuszdabrowski.pl/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/" hreflang="en"><link data-rh="true" rel="alternate" href="https://mateuszdabrowski.pl/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://F4XVDD6BM8-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.e6089e6d.css">
<link rel="preload" href="/assets/js/runtime~main.b2ca85c7.js" as="script">
<link rel="preload" href="/assets/js/main.ec375e69.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-horizontal-light-2x.png" alt="Mateusz DƒÖbrowski Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-horizontal-dark-2x.png" alt="Mateusz DƒÖbrowski Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link" href="/docs/">Docs &amp; Snippets</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/docs/zen-of-sfmc/">Zen of SFMC</a></li><li><a class="dropdown__link navbar__link--active" href="/docs/ssjs/ssjs-if-and-switch/">SSJS</a></li><li><a class="dropdown__link navbar__link--active" href="/docs/js/js-if-and-switch/">JavaScript</a></li><li><a class="dropdown__link navbar__link--active" href="/docs/ampscript/ampscript-style-guide/">AMPScript</a></li><li><a class="dropdown__link navbar__link--active" href="/docs/sql/sfmc-sql-basics/">SFMC SQL</a></li><li><a class="dropdown__link navbar__link--active" href="/docs/config/sfmc-config-features-on-demand/">SFMC Config</a></li><li><a class="dropdown__link navbar__link--active" href="/docs/usecase/sfmc-cloud-page-apps/">SFMC Use Cases</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/tags/">Tags</a><a class="navbar__item navbar__link" href="/sites/ideas/">Ideas</a><a class="navbar__item navbar__link" href="/sites/my-toolset/">Toolset</a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/mateusz-dabrowski-marketing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-linkedin-link" aria-label="LinkedIn Profile"></a><a href="https://twitter.com/MDabrowskiPL" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-twitter-link" aria-label="Twitter Profile"></a><a href="https://trailblazer.me/id/madabrowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-salesforce-link" aria-label="Trailblazer Profile"></a><a href="https://github.com/MateuszDabrowski" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Docs &amp; Snippets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/zen-of-sfmc/">Zen of SFMC</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/ssjs/ssjs-if-and-switch/">SSJS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/ssjs-if-and-switch/">If &amp; Switch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/ssjs-loops/">Loops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/debugging-ssjs/">Debugging &amp; Error Handling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/ssjs-style-guide/">Style Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/ssjs-vs-ampscript-performance/">Performance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/">¬ª SSJS Snippets</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/">AMPScript in SSJS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/ssjs-snippet-mobileconnect-phone-change/">MobileConnect Phone Change</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/ssjs-snippet-ssjs-script-template/">SSJS Script Template</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/js/js-if-and-switch/">JavaScript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/ampscript/ampscript-style-guide/">AMPScript</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ampscript/ampscript-style-guide/">Style Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ssjs/ssjs-vs-ampscript-performance/">Performance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/">¬ª AMPScript Snippets</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/">AMPScript in SSJS</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/sql/sfmc-sql-basics/">SFMC SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/config/sfmc-config-permissions/">SFMC Config</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/usecase/tailor-with-data/">SFMC Use Cases</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/">üè†</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">SSJS</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">¬ª SSJS Snippets</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/docs/ssjs/ssjs-snippet-ampscript-in-ssjs/">AMPScript in SSJS</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>AMPScript in SSJS</h1></header><p id="leadText_qzwo">Not all AMPScript functions are available in SSJS. But you still can use them.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="problem-with-missing-ssjs-functions">Problem with missing SSJS functions<a class="hash-link" href="#problem-with-missing-ssjs-functions" title="Direct link to heading">‚Äã</a></h2><p>SSJS language has many features missing from AMPScript - <a href="/docs/ssjs/debugging-ssjs/#try-to-catch-the-error">try/catch blocks</a>, arrays and objects to mention the most used ones. But some things are available only in AMPScript.</p><p>Some, like <code>ProperCase</code> function, can be recreated in SSJS with a bit of RegEx creativity. Other, like <code>RetrieveSalesforceObjects</code>, cannot (unless you decide on building custom wrappers around Salesforce API).</p><p>Either way, you are in for a time consuming, error-prone custom coding. Is there a better way?</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="solution">Solution<a class="hash-link" href="#solution" title="Direct link to heading">‚Äã</a></h2><p>You guessed it - yes, there is a better way. You can run AMPScript code with your SSJS. The simple answer to this problem is <code>Platform.Function.TreatAsContent()</code> SSJS function.</p><p>But the good answer is few lines longer:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @function ampScript</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @description Executes provided AMPScript code and returns value assigned to @Response variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param {string} code - String of AMPScript code without start/end delimiters. Final outcome should be assigned to @Response to enable passing back to SSJS</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return {?string} - Returns value from AMPScript execution if any was assigned to @Response variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ampScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">code</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> ampBlock </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\%\%[&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> code </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;]\%\%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Platform</span><span class="token punctuation" style="color:#393A34">.</span><span class="token known-class-name class-name">Function</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">TreatAsContent</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ampBlock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token maybe-class-name">Variable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">GetValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;@response&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>You Should Know</h5></div><div class="admonition-content"><p>As we are using <code>Variable.GetValue</code> here, you will need to import Salesforce Marketing Cloud SSJS Core library at the top of your script.</p><p>Just add <code>Platform.Load(&#x27;core&#x27;, &#x27;1&#x27;)</code> right after <code>&lt;script runat=&quot;server&quot;&gt;</code> and you are good to go!</p></div></div><p>Instead of writing your AMPScript execution wrapper every time from scratch, here is a ready-to-use function that you can copy-paste across your scripts that allows you to use ampscript and do it gracefully.</p><p>Sure, it still uses the <code>Platform.Function.TreatAsContent()</code> at its heart, but there are two additional tricks:</p><ol><li><code>var ampBlock = &#x27;\%\%[&#x27; + code + &#x27;]\%\%&#x27;</code>: allows you to write AMPScript without the block symbols and adds them in the last moment. This way, Marketing Cloud will execute your code once you pass it to the <code>Platform.Function.TreatAsContent()</code> function. It is essential when you want to <a href="#dynamic-ampscript-code">insert SSJS in your AMPScript</a>.</li><li><code>return Variable.GetValue(&#x27;@response&#x27;);</code>: allows you to pull back data from your AMPScript to the SSJS. For it to work, you must <code>SET</code> the <code>@response</code> variable in your AMPScript. Whatever value you assign to the <code>@response</code> in the AMPScript context, will be returned to your SSJS context.</li></ol><p>How to use it? Pass the AMPScript code in the function and, if you want to do something with <code>@response</code> value, assign it to an SSJS variable.</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">As JavaScript lacks native ProperCase, we can use AMPScript for that</div><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> properCaseFullName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ampScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SET @response = ProperCase(AttributeValue(&#x27;fullName&#x27;))&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>You Should Know</h5></div><div class="admonition-content"><p>Be sure only to use this approach if there is no equivalent SSJS solution, as mixing languages will <a href="/docs/ssjs/ssjs-vs-ampscript-performance/">impact performance</a>. It is crucial for code in the messages that Marketing Cloud will execute on send time.</p><p>For example, if you are only planning to use ProperCase, it might be better to go the RegEx path for significant volume messaging.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="options">Options<a class="hash-link" href="#options" title="Direct link to heading">‚Äã</a></h2><p>You can adapt the above script to suit your needs better.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="long-ampscript-code">Long AMPScript Code<a class="hash-link" href="#long-ampscript-code" title="Direct link to heading">‚Äã</a></h3><p>Above example is a short and straightforward AMPScript. However, you will need a bit more code to do the job in many cases. You can write it as a single line if you want, but I recommend you split it into separate lines for readability purposes.</p><p>You can do it quickly, by just concatenating strings with <code>+</code>.</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Check whether there is a Campaign in Salesforce called &#x27;WelcomeCampaign2021&#x27;</div><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ampScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SET @retrieve = RetrieveSalesforceObjects(&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;Campaign&#x27;, &#x27;Id&#x27;, &#x27;Name&#x27;, &#x27;=&#x27;, &#x27;WelcomeCampaign2021&#x27;) &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;IF RowCount(@retrieve) &gt; 0 THEN SET @response = &#x27;true&#x27; &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ELSE SET @response = &#x27;false&#x27; ENDIF&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>You Should Know</h5></div><div class="admonition-content"><p>To use any Salesforce Object functions, you will need to have Marketing Cloud Connect implemented to tie in your Marketing Cloud and Sales or Service Cloud.</p></div></div><p>Be sure always to check, whether you have space either at the end of the previous line or beginning of the new line. Otherwise, after concatenation, you might end up with incorrect code.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="dynamic-ampscript-code">Dynamic AMPScript Code<a class="hash-link" href="#dynamic-ampscript-code" title="Direct link to heading">‚Äã</a></h3><p>Using AMPScript via SSJS not only enables additional features for Server-Side JavaScript. It also allows you to make your AMPScript more dynamic by leveraging variables in the loops:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Same check as above, but for multiple campaigns and output to an array</div><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> availableCampaigns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> campaignName </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> campaignList</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ampScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SET @retrieve = RetrieveSalesforceObjects(&quot;</span><span class="token plain"></span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;Campaign&#x27;, &#x27;Id&#x27;, &#x27;Name&#x27;, &#x27;=&#x27;, &#x27;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> campaignName </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;) &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;IF RowCount(@retrieve) &gt; 0 THEN SET @response = &#x27;true&#x27; &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ELSE SET @response = &#x27;false&#x27; ENDIF&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reponse</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> availableCampaigns</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">campaignName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>It is even more useful when you have variability in what you want to create. For example, let&#x27;s consider a use case where you want to create Campaigns in Salesforce from Marketing Cloud, but only some of your campaigns have an End Date known from the beginning.</p><p>In <code>CreateSalesforceObject</code> AMPScript function, you must pass all fields with their values and a count of fields added to the object. With SSJS, you can use the <code>length</code> method to count the Campaign&#x27;s fields in each loop&#x27;s run. Then pass the outcome to the call parameters just as in the example above.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="working-with-ampscript-on-lists--objects">Working with AMPScript on Lists &amp; Objects<a class="hash-link" href="#working-with-ampscript-on-lists--objects" title="Direct link to heading">‚Äã</a></h3><p>Unfortunately, AMPScript doesn&#x27;t support list or objects. Fortunately, SSJS do. We will need a bit of creativity to pull that off, but it makes life so much easier once done.</p><p>The easy example is visible in the <a href="#dynamic-ampscript-code">previous section</a> - the snippet creates an array of Campaigns available in Salesforce.</p><p>But we can go so much farther than that:</p><div class="codeBlockContainer_I0IT language-js theme-code-block"><div class="codeBlockContent_wNvx js"><pre tabindex="0" class="prism-code language-js codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ampScript</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SET @retrieve = RetrieveSalesforceObjects(&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;Campaign&#x27;, &#x27;Name,Id,StartDate,EndDate&#x27;, &#x27;IsActive&#x27;, &#x27;=&#x27;, &#x27;True&#x27;) &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SET @rowCount = RowCount(@retrieve) SET @response = &#x27;&#x27; &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;IF @rowCount &gt; 0 THEN FOR @counter = 1 TO @rowCount DO &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SET @row = Row(@retrieve, @counter) &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SET @name = Field(@row, &#x27;Name&#x27;) SET @id = Field(@row, &#x27;Id&#x27;) &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SET @startDate = Field(@row, &#x27;StartDate&#x27;) SET @endDate = Field(@row, &#x27;EndDate&#x27;) &quot;</span><span class="token plain"></span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SET @rowData = Concat(@name, &#x27;,&#x27;, @id, &#x27;,&#x27;, @startDate, &#x27;,&#x27;, @endDate) &quot;</span><span class="token plain"></span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;SET @response = Concat(@response, @rowData, &#x27;;&#x27;) &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;NEXT @counter ENDIF&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token plain">response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> campaignData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line docusaurus-highlight-code-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> responseRowData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    campaignData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> responseRowData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> responseRowData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">startDate</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> responseRowData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">endDate</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> responseRowData</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Ok, a lot to unpack. But trust me, it&#x27;s worth it. Let&#x27;s go!</p><p>The first line is easy - we are using <code>RetrieveSalesforceObjects</code> function to get a list of all active Salesforce Campaigns and limit the fields we need about them.</p><p>Next, we have a standard AMPScript way of iterating over the function&#x27;s outcomes.</p><p>Now starts the exciting part - we are creating an AMPScript variable for each field, concatenate it using a comma and then adding it to the end of the <code>@response</code> variable - semicolon-separated.</p><div class="codeBlockContainer_I0IT language-css theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_BvAR">Structure of the AMPScript output</div><div class="codeBlockContent_wNvx css"><pre tabindex="0" class="prism-code language-css codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">Name1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">Id1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">StartDate1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">EndDate1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">Name2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">Id2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">StartDate2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">EndDate2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">Name3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">Id3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">StartDate3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">EndDate3</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>As we assigned the final string to <code>@response</code>, the function will return it to the SSJS context.</p><p>Once it&#x27;s there, we are leveraging the SSJS by splitting the string on semicolons to create an array of substrings containing each Salesforce Campaign&#x27;s details.</p><p>Then we loop over it and split each Campaign string by comma. With the deconstructed data, we create a nice and clean <code>campaignData</code> object that we can use in the rest of our code. Neat.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/marketing-cloud/">Marketing Cloud</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/ssjs/">SSJS</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/amp-script/">AMPScript</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/snippet/">Snippet</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/MateuszDabrowski/mateuszdabrowski.pl/edit/master/docs/ssjs/ssjs-snippet-ampscript-in-ssjs.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-03-04T15:56:40.000Z">3/4/2022</time></b> by <b>Mateusz DƒÖbrowski</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ssjs/ssjs-vs-ampscript-performance/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Performance</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/ssjs/ssjs-snippet-mobileconnect-phone-change/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">MobileConnect Phone Change</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#problem-with-missing-ssjs-functions" class="table-of-contents__link toc-highlight">Problem with missing SSJS functions</a></li><li><a href="#solution" class="table-of-contents__link toc-highlight">Solution</a></li><li><a href="#options" class="table-of-contents__link toc-highlight">Options</a><ul><li><a href="#long-ampscript-code" class="table-of-contents__link toc-highlight">Long AMPScript Code</a></li><li><a href="#dynamic-ampscript-code" class="table-of-contents__link toc-highlight">Dynamic AMPScript Code</a></li><li><a href="#working-with-ampscript-on-lists--objects" class="table-of-contents__link toc-highlight">Working with AMPScript on Lists &amp; Objects</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs &amp; Snippets</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/ssjs/ssjs-if-and-switch/">SSJS</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/js/js-if-and-switch/">JavaScript</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ampscript/ampscript-style-guide/">AMPScript</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sql/sfmc-sql-basics/">SFMC SQL</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/config/sfmc-config-features-on-demand/">SFMC Config</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/usecase/sfmc-cloud-page-apps/">SFMC Use Cases</a></li></ul></div><div class="col footer__col"><div class="footer__title">About</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/zen-of-sfmc/">Zen of SFMC</a></li><li class="footer__item"><a class="footer__link-item" href="/sites/my-toolset/">Toolset</a></li><li class="footer__item"><a class="footer__link-item" href="/sites/ideas/">Ideas</a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sites/licence/">Licence &amp; Attribution</a></li><li class="footer__item"><a class="footer__link-item" href="/sites/privacy/">Privacy</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/assets/js/runtime~main.b2ca85c7.js"></script>
<script src="/assets/js/main.ec375e69.js"></script>
</body>
</html>