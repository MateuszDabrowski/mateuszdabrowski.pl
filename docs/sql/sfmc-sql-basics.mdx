---
id: sfmc-sql-basics
title: SFMC SQL Basics
---

import { LeadText } from '../../src/components/LeadText.js';

<LeadText content='' />

## SQL in Salesforce Marketing Cloud

SQL is

The main difference from standard SQL (more or less SQL Server 2005) is that Salesforce Marketing Cloud supports only SELECT statement. Neither INSERT, UPDATE or DELETE are officially supported. This is because the queries are executed as a part of backend query and are limited to provide non-breakable functionality.

Another limiting characteristic of SFMC SQL is limitation of queries to data stored in data extensions or system data views. The results are always saved in data extensions.

Finally, the very important limitation that you might hit as your Marketing Cloud grows is the AutoKill. This script automatically stops your query if its execution time exceeds the 30 minutes limit.

## Fundamentals of SQL queries

Marketing Cloud Commands
* SELECT: command to locate data on a database
* FROM: location where data reside within Marketing Cloud (usually a data extension)
* JOIN: allows the query to search multiple tables and/or data extensions
* WHERE: used to filter out data you do/don’t want

SELECT emailaddress as ‘Email_Address’, [Favorite Colour] as ‘Favorite_Color’
FROM [MasterData Extension] m
INNER JOIN JuneMarketingSend j
ON m.emailaddress = j.emailaddress
WHERE m.emailaddress is not NULL

Running this query retrieves email and favorite color from the master data extension, and joins it with any matching email addresses from the June marketing send. Additionally, it only returns emails that are not missing. Also notice the m and the j. These are SQL aliases that are used to give a table, or a field in a table, a temporary name. This is especially helpful when you have a common field name between data extensions, like CustomerID or EmailAddress. You can also see it written like the following.

SELECT o.OrderID, o.OrderDate, c.CustomerName
FROM Customers AS c, Orders AS o
WHERE c.CustomerID=o.CustomerID

Example for exclusive offer to customers who have opened an email in the last 6 months and have made a purchase during that time.

SELECT c.EmailAddress, c.CustomerID, c.First_Name
FROM Customers c
INNER JOIN Purchases p
ON c.CustomerID = p.CustomerID
WHERE [Purchase Date] > DateAdd(month, -6, GetDate()) AND [Open Date] > DateAdd(month, -6, GetDate())


Common Queries
Parent Accounts
You can query data extensions in the Shared Data Extension folder from the parent account by adding the prefix ent. to the data extension name in the query. 
SELECT EmailAddress
FROM ent.MasterDataExtension

All the Data
Sometimes you want everything.
SELECT *
FROM MasterDataExtension
Use SELECT * very carefully as this can cause slowness in the system as it is processing a large amount of data. The larger the dataset, the greater time and effort the system has to use to obtain the data. Queries time-out after 30 minutes, and the more data to process, the more likely the query can time out. To help with this, it is more effective to provide the exact fields you are looking for in the query. 
SELECT field1, field2, field3
FROM MasterDataExtension


System Data Views
System data views are Salesforce-created queries that you can use to find information about your subscribers. Just remember, you won’t be able to make changes to these precreated data views. Here are some of the most commonly used views.
Full list: https://help.salesforce.com/articleView?id=mc_as_data_views.htm&type=5

Bounce
_bounce
Identify and then suppress commonly bounced email addresses from sends.

Click and Open
_Click
_Open
Query these data views in Automation Studio to view click and open data for emails from your Marketing Cloud account.
Helps to identify additional messaging opportunities by indicating subscriber engagement on a specific JobID.
Click and open tracking data displays in Central Standard Time, does not observe Daylight Savings Time, and is rounded to the nearest second.

Complaint
_Complaint
Query this data view in Automation Studio to view complaints data related to emails from your Marketing Cloud account.
Use to prune your lists to ensure more accurate audiences and improve deliverability.

SELECT SubscriberKey,JobID,SMTPBounceReason
FROM _Complaint

Journey
_Journey
Find a journey's status, created and last modified date, and other general journey information using this Journey Builder data view.


## Best Practices

1. Avoid non-searchable operators for the WHERE clause (OR, NOT, <, >, NOT EXISTS, NOT IN, NOT LIKE, intrinsic functions). Those operators cannot take advantage of indexes and cause the query activity to run more slowly. More efficient operators (=, AND) improve queries.
2. For queries involving data views, implement a 6-month cap. Often the performance is dramatically better limited to no more than 30 days.
3. Think about the query with future in the mind. It is especially important for queries that are supposed to be backbones of your data management flow in Marketign Cloud. Even if it works great now, consider how it will behave once you have more data in the system. One of the great ways to not trigger AutoKill is to implement retention periods for the Data Extensions used in the query.
4. Stage the data! Break the work into pieces, if possible, or use an AltText Query Activity and implement with small, committed batches.
5. Limit your update sets to one million records and batch through them.
6. Avoid Data Extensions spanning a cumulative field width greater than 4000 characters.
7. Limit the use of SELECT *

## Query Studio

