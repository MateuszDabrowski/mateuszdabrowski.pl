(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{118:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return u})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return b}));var a=n(2),o=n(6),r=(n(0),n(124)),s=n(131),c=n(132),i=n(125),u={id:"wsproxy",title:"WSProxy Basics"},l={id:"ssjs/wsproxy",isDocsHomePage:!1,title:"WSProxy Basics",description:"Simple Object Access Protocol is one of the most popular ways of for exchanging structured information. It's old. It's complex. It's hard to wrap head around quickly. Most of the modern web uses REST API (more about it in a minute). But SOAP is still alive in a lot of places. Salesforce Marketing Cloud included. Sort of.",source:"@site/docs/ssjs/wsproxy.mdx",permalink:"/docs/ssjs/wsproxy",editUrl:"https://github.com/MateuszDabrowski/mateuszdabrowski.pl/edit/master/docs/ssjs/wsproxy.mdx",lastUpdatedBy:"Mateusz D\u0105browski",lastUpdatedAt:1594849810},p=[{value:"WSProxy and SOAP",id:"wsproxy-and-soap",children:[]}],m={rightToc:p};function b(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},m,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)(i.a,{content:"Make SOAP API great again!",mdxType:"LeadText"}),Object(r.b)("p",null,"Simple Object Access Protocol is one of the most popular ways of for exchanging structured information. It's old. It's complex. It's hard to wrap head around quickly. Most of the modern web uses REST API (more about it in a minute). But SOAP is still alive in a lot of places. Salesforce Marketing Cloud included. Sort of."),Object(r.b)("p",null,"As far as SFMC is still using ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://developer.salesforce.com/docs/atlas.en-us.mc-apis.meta/mc-apis/web_service_guide.htm",title:"SFMC SOAP API Official Documentation"}),"SOAP API"),", it is in freeze mode. Not actively developed (officialy) as focus is put on extending the scope of the REST API. But right now we are in this weird transitional period, when some features of Marketing Cloud are accessible with the SOAP, some with the REST. And some with both, even when official documentation disagree (for example undocumented ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://gortonington.com/creating-a-triggered-automation-in-sfmc-via-rest-api/",title:'Blog post by Gregory "Gortonigton" Gifford'}),"Automation Endpoint"),"). When we can expect fully RESTful SFMC? Recent launch of the WSProxy should be enough for an answer. Let's dive in why."),Object(r.b)("h2",{id:"wsproxy-and-soap"},"WSProxy and SOAP"),Object(r.b)("p",null,"What is WSProxy? It's a SSJS wrapper around the bad and ugly of the SOAP API. And it is absolutely wonderful. One code comparision is worth thousand words."),Object(r.b)(s.a,{defaultValue:"soap",values:[{label:"SOAP API Call",value:"soap"},{label:"Standard SSJS SOAP Call",value:"ssjs"},{label:"WSProxy SOAP Call",value:"wsproxy"}],mdxType:"Tabs"},Object(r.b)(c.a,{value:"soap",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-xml",metastring:'title="Create an Automation with SOAP"',title:'"Create',an:!0,Automation:!0,with:!0,'SOAP"':!0}),'<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"\n                  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                  xmlns:xsd="http://www.w3.org/2001/XMLSchema"\n                  xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing"\n                  xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"\n                  xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\n    <soapenv:Header>\n        <wsse:Security soapenv:mustUnderstand="1">\n            <wsse:UsernameToken>\n                <wsse:Username>username</wsse:Username>\n                <wsse:Password>password</wsse:Password>\n            </wsse:UsernameToken>\n        </wsse:Security>\n    </soapenv:Header>\n    <soapenv:Body>\n        <CreateRequest xmlns="http://exacttarget.com/wsdl/partnerAPI">\n            <Options/>\n            <Objects xsi:type="Automation">\n                <Client>\n                    <ID>1234567</ID>\n                </Client>\n                <Name>AUT_ONEOFF</Name>\n                <CustomerKey>AUT_ONEOFF</CustomerKey>\n                <Description>AUT_ONEOFF</Description>\n                <AutomationTasks>\n                    <AutomationTask>\n                        <PartnerKey xsi:nil="true"/>\n                        <ObjectID xsi:nil="true"/>\n                        <Name>Task 1</Name>\n                        <Activities>\n                            <Activity>\n                                <PartnerKey xsi:nil="true"/>\n                                <ObjectID>c7ccca24-4567-4317-b8d0-3874d69c130c</ObjectID>\n                                <Name>Query 1</Name>\n                                <ActivityObject xsi:type="QueryDefinition">\n                                    <PartnerKey xsi:nil="true"/>\n                                    <ObjectID>c7ccca24-4567-4317-b8d0-3874d69c130c</ObjectID>\n                                    <CustomerKey>546012e7-4438-4526-9e6c-5ec73939848b</CustomerKey>\n                                    <Name>BrowseAbandon_US_Unica_Sendable_Audience_Approved</Name>\n                                </ActivityObject>\n                            </Activity>\n                        </Activities>\n                    </AutomationTask>\n                </AutomationTasks>\n                <AutomationType>scheduled</AutomationType>\n            </Objects>\n        </CreateRequest>\n    </soapenv:Body>\n</soapenv:Envelope>\n')),Object(r.b)("p",null,"Cleaned code sample from ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://developer.salesforce.com/docs/atlas.en-us.noversion.mc-apis.meta/mc-apis/interacting_with_automation_studio_via_the_web_service_soap_api.htm"}),"official Marketing Cloud Documentation"))),Object(r.b)(c.a,{value:"ssjs",mdxType:"TabItem"},Object(r.b)("p",null,"TODO: Fix this snippet"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-html"}),'<script runat="server">\n    Platform.Load("core","1");\n\n    var Automation = Platform.Function.CreateObject("Automation");\n    Platform.Function.SetObjectProperty(Automation, "Name", "AUT_ONEOFF);\n    Platform.Function.SetObjectProperty(Automation, "CustomerKey", "AUT_ONEOFF);\n    Platform.Function.SetObjectProperty(Automation, "Description", "AUT_ONEOFF);\n    Platform.Function.SetObjectProperty(Automation, "AutomationType", "scheduled");\n\n    var ActivityObject = Platform.Function.CreateObject("ActivityObject");\n    Platform.Function.SetObjectProperty(ActivityObject, "ObjectID", "c7ccca24-4567-4317-b8d0-3874d69c130c");\n    Platform.Function.SetObjectProperty(ActivityObject, "CustomerKey", "546012e7-4438-4526-9e6c-5ec73939848b");\n    Platform.Function.SetObjectProperty(ActivityObject, "Name", "BrowseAbandon_US_Unica_Sendable_Audience_Approved");\n\n    var Activity = Platform.Function.CreateObject("Activity");\n    Platform.Function.SetObjectProperty(Activity, "ObjectID", "c7ccca24-4567-4317-b8d0-3874d69c130c");\n    Platform.Function.SetObjectProperty(Activity, "Name", "Query 1");\n    Platform.Function.SetObjectProperty(Activity, "ActivityObject", ActivityObject);\n\n    var Activities = Platform.Function.CreateObject("Activities");\n    Platform.Function.SetObjectProperty(Activities, "Activities", Activity);\n\n    var AutomationTaskOne = Platform.Function.CreateObject("AutomationTask");\n    Platform.Function.SetObjectProperty(AutomationTaskOne, "Name", "Task One");\n    Platform.Function.AddObjectArrayItem(AutomationTaskOne, "Activities", ImportActivity);\n    Platform.Function.AddObjectArrayItem(Automation, "AutomationTasks", AutomationTaskOne);\n\n    var CreateRequest = Platform.Function.CreateObject("CreateRequest");\n    var CreateOptions = Platform.Function.CreateObject("CreateOptions");\n    Platform.Function.SetObjectProperty(CreateRequest, "Options", CreateOptions);\n    Platform.Function.AddObjectArrayItem(CreateRequest, "Objects", Automation);\n\n    var StatusAndRequestID = [0,0];\n    var CreateResults = Platform.Function.InvokeCreate(CreateRequest, StatusAndRequestID);\n<\/script>\n'))),Object(r.b)(c.a,{value:"wsproxy",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"")))),Object(r.b)("p",null,"Topics to cover:\nWhat is WSProxy (no Core)\nSOAP API documentation: ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://developer.salesforce.com/docs/atlas.en-us.mc-apis.meta/mc-apis/web_service_guide.htm"}),"https://developer.salesforce.com/docs/atlas.en-us.mc-apis.meta/mc-apis/web_service_guide.htm"),"\nHow to translate SOAP envelope to WSProxy\nOperations"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Create"),Object(r.b)("li",{parentName:"ul"},"Retrieve\netc.\nItem vs Batch")))}b.isMDXComponent=!0},124:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var a=n(0),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=o.a.createContext({}),l=function(e){var t=o.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=l(e.components);return o.a.createElement(u.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=l(n),b=a,d=p["".concat(s,".").concat(b)]||p[b]||m[b]||r;return n?o.a.createElement(d,c(c({ref:t},u),{},{components:n})):o.a.createElement(d,c({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,s=new Array(r);s[0]=b;var c={};for(var i in t)hasOwnProperty.call(t,i)&&(c[i]=t[i]);c.originalType=e,c.mdxType="string"==typeof e?e:a,s[1]=c;for(var u=2;u<r;u++)s[u]=n[u];return o.a.createElement.apply(null,s)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},125:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(0),o=n.n(a),r=n(93),s=n.n(r);const c=({content:e})=>o.a.createElement(o.a.Fragment,null,o.a.createElement("p",{id:s.a.leadText},e))},127:function(e,t,n){"use strict";function a(e){var t,n,o="";if("string"==typeof e||"number"==typeof e)o+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}t.a=function(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(o&&(o+=" "),o+=t);return o}},128:function(e,t,n){"use strict";var a=n(0);const o=Object(a.createContext)({tabGroupChoices:{},setTabGroupChoices:()=>{},isAnnouncementBarClosed:!1,closeAnnouncementBar:()=>{}});t.a=o},129:function(e,t,n){"use strict";var a=n(0),o=n(128);t.a=function(){return Object(a.useContext)(o.a)}},131:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(129),s=n(127),c=n(94),i=n.n(c);const u=37,l=39;t.a=function(e){const{block:t,children:n,defaultValue:c,values:p,groupId:m}=e,{tabGroupChoices:b,setTabGroupChoices:d}=Object(r.a)(),[f,O]=Object(a.useState)(c);if(null!=m){const e=b[m];null!=e&&e!==f&&p.some(t=>t.value===e)&&O(e)}const y=e=>{O(e),null!=m&&d(m,e)},v=[];return o.a.createElement("div",null,o.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(s.a)("tabs",{"tabs--block":t})},p.map(({value:e,label:t})=>o.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":f===e,className:Object(s.a)("tabs__item",i.a.tabItem,{"tabs__item--active":f===e}),key:e,ref:e=>v.push(e),onKeyDown:e=>((e,t,n)=>{switch(n.keyCode){case l:((e,t)=>{const n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()})(e,t);break;case u:((e,t)=>{const n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()})(e,t)}})(v,e.target,e),onFocus:()=>y(e),onClick:()=>y(e)},t))),o.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter(e=>e.props.value===f)[0]))}},132:function(e,t,n){"use strict";var a=n(0),o=n.n(a);t.a=function(e){return o.a.createElement("div",null,e.children)}}}]);